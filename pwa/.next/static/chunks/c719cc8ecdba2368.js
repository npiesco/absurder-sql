(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,65756,e=>{"use strict";var t=e.i(74907);let n=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim();var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)(({color:e="currentColor",size:n=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:i="",children:s,iconNode:d,...c},u)=>(0,t.createElement)("svg",{ref:u,...r,width:n,height:n,stroke:e,strokeWidth:l?24*Number(o)/Number(n):o,className:a("lucide",i),...!s&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,n])=>(0,t.createElement)(e,n)),...Array.isArray(s)?s:[s]])),l=(e,r)=>{let l=(0,t.forwardRef)(({className:l,...i},s)=>(0,t.createElement)(o,{ref:s,iconNode:r,className:a(`lucide-${n(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,l),...i}));return l.displayName=n(e),l};e.s(["default",()=>l],65756)},33690,e=>{"use strict";var t=e.i(74907),n=e.i(69617),a=e.i(9486),r=e=>{var r;let l,i,{present:s,children:d}=e,c=function(e){var n,r;let[l,i]=t.useState(),s=t.useRef(null),d=t.useRef(e),c=t.useRef("none"),[u,m]=(n=e?"mounted":"unmounted",r={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>r[e][t]??e,n));return t.useEffect(()=>{let e=o(s.current);c.current="mounted"===u?e:"none"},[u]),(0,a.useLayoutEffect)(()=>{let t=s.current,n=d.current;if(n!==e){let a=c.current,r=o(t);e?m("MOUNT"):"none"===r||t?.display==="none"?m("UNMOUNT"):n&&a!==r?m("ANIMATION_OUT"):m("UNMOUNT"),d.current=e}},[e,m]),(0,a.useLayoutEffect)(()=>{if(l){let e,t=l.ownerDocument.defaultView??window,n=n=>{let a=o(s.current).includes(CSS.escape(n.animationName));if(n.target===l&&a&&(m("ANIMATION_END"),!d.current)){let n=l.style.animationFillMode;l.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===l.style.animationFillMode&&(l.style.animationFillMode=n)})}},a=e=>{e.target===l&&(c.current=o(s.current))};return l.addEventListener("animationstart",a),l.addEventListener("animationcancel",n),l.addEventListener("animationend",n),()=>{t.clearTimeout(e),l.removeEventListener("animationstart",a),l.removeEventListener("animationcancel",n),l.removeEventListener("animationend",n)}}m("ANIMATION_END")},[l,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:t.useCallback(e=>{s.current=e?getComputedStyle(e):null,i(e)},[])}}(s),u="function"==typeof d?d({present:c.isPresent}):t.Children.only(d),m=(0,n.useComposedRefs)(c.ref,(r=u,(i=(l=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in l&&l.isReactWarning)?r.ref:(i=(l=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in l&&l.isReactWarning)?r.props.ref:r.props.ref||r.ref));return"function"==typeof d||c.isPresent?t.cloneElement(u,{ref:m}):null};function o(e){return e?.animationName||"none"}r.displayName="Presence",e.s(["Presence",()=>r])},34219,32977,e=>{"use strict";let t,n,a;var r=e.i(73444),o=e.i(75784),l=e.i(74907),i=e.i(35560),s=e.i(69617),d=e.i(26972),c=e.i(37707),u=e.i(29275),m=e.i(54215),f=e.i(30398),p=e.i(53711),g=e.i(33690),x=e.i(67329),h=e.i(77329),v=e.i(76283),y=e.i(60567),w=Symbol("radix.slottable");function b(e){return l.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===w}var j="Dialog",[N,D]=(0,d.createContextScope)(j),[C,E]=N(j),R=e=>{let{__scopeDialog:t,children:n,open:a,defaultOpen:o,onOpenChange:i,modal:s=!0}=e,d=l.useRef(null),m=l.useRef(null),[f,p]=(0,u.useControllableState)({prop:a,defaultProp:o??!1,onChange:i,caller:j});return(0,r.jsx)(C,{scope:t,triggerRef:d,contentRef:m,contentId:(0,c.useId)(),titleId:(0,c.useId)(),descriptionId:(0,c.useId)(),open:f,onOpenChange:p,onOpenToggle:l.useCallback(()=>p(e=>!e),[p]),modal:s,children:n})};R.displayName=j;var k="DialogTrigger",P=l.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,o=E(k,n),l=(0,s.useComposedRefs)(t,o.triggerRef);return(0,r.jsx)(x.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":q(o.open),...a,ref:l,onClick:(0,i.composeEventHandlers)(e.onClick,o.onOpenToggle)})});P.displayName=k;var O="DialogPortal",[S,A]=N(O,{forceMount:void 0}),I=e=>{let{__scopeDialog:t,forceMount:n,children:a,container:o}=e,i=E(O,t);return(0,r.jsx)(S,{scope:t,forceMount:n,children:l.Children.map(a,e=>(0,r.jsx)(g.Presence,{present:n||i.open,children:(0,r.jsx)(p.Portal,{asChild:!0,container:o,children:e})}))})};I.displayName=O;var _="DialogOverlay",T=l.forwardRef((e,t)=>{let n=A(_,e.__scopeDialog),{forceMount:a=n.forceMount,...o}=e,l=E(_,e.__scopeDialog);return l.modal?(0,r.jsx)(g.Presence,{present:a||l.open,children:(0,r.jsx)(M,{...o,ref:t})}):null});T.displayName=_;var $=((a=l.forwardRef((e,t)=>{let{children:n,...a}=e;if(l.isValidElement(n)){var r;let e,o,i=(r=n,(o=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.ref:(o=(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.props.ref:r.props.ref||r.ref),d=function(e,t){let n={...t};for(let a in t){let r=e[a],o=t[a];/^on[A-Z]/.test(a)?r&&o?n[a]=(...e)=>{let t=o(...e);return r(...e),t}:r&&(n[a]=r):"style"===a?n[a]={...r,...o}:"className"===a&&(n[a]=[r,o].filter(Boolean).join(" "))}return{...e,...n}}(a,n.props);return n.type!==l.Fragment&&(d.ref=t?(0,s.composeRefs)(t,i):i),l.cloneElement(n,d)}return l.Children.count(n)>1?l.Children.only(null):null})).displayName="DialogOverlay.RemoveScroll.SlotClone",t=a,(n=l.forwardRef((e,n)=>{let{children:a,...o}=e,i=l.Children.toArray(a),s=i.find(b);if(s){let e=s.props.children,a=i.map(t=>t!==s?t:l.Children.count(e)>1?l.Children.only(null):l.isValidElement(e)?e.props.children:null);return(0,r.jsx)(t,{...o,ref:n,children:l.isValidElement(e)?l.cloneElement(e,void 0,a):null})}return(0,r.jsx)(t,{...o,ref:n,children:a})})).displayName="DialogOverlay.RemoveScroll.Slot",n),M=l.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,o=E(_,n);return(0,r.jsx)(v.RemoveScroll,{as:$,allowPinchZoom:!0,shards:[o.contentRef],children:(0,r.jsx)(x.Primitive.div,{"data-state":q(o.open),...a,ref:t,style:{pointerEvents:"auto",...a.style}})})}),F="DialogContent",U=l.forwardRef((e,t)=>{let n=A(F,e.__scopeDialog),{forceMount:a=n.forceMount,...o}=e,l=E(F,e.__scopeDialog);return(0,r.jsx)(g.Presence,{present:a||l.open,children:l.modal?(0,r.jsx)(L,{...o,ref:t}):(0,r.jsx)(W,{...o,ref:t})})});U.displayName=F;var L=l.forwardRef((e,t)=>{let n=E(F,e.__scopeDialog),a=l.useRef(null),o=(0,s.useComposedRefs)(t,n.contentRef,a);return l.useEffect(()=>{let e=a.current;if(e)return(0,y.hideOthers)(e)},[]),(0,r.jsx)(B,{...e,ref:o,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,i.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:(0,i.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()}),onFocusOutside:(0,i.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault())})}),W=l.forwardRef((e,t)=>{let n=E(F,e.__scopeDialog),a=l.useRef(!1),o=l.useRef(!1);return(0,r.jsx)(B,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(a.current||n.triggerRef.current?.focus(),t.preventDefault()),a.current=!1,o.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(a.current=!0,"pointerdown"===t.detail.originalEvent.type&&(o.current=!0));let r=t.target;n.triggerRef.current?.contains(r)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&o.current&&t.preventDefault()}})}),B=l.forwardRef((e,t)=>{let{__scopeDialog:n,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:i,...d}=e,c=E(F,n),u=l.useRef(null),p=(0,s.useComposedRefs)(t,u);return(0,h.useFocusGuards)(),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.FocusScope,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:o,onUnmountAutoFocus:i,children:(0,r.jsx)(m.DismissableLayer,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":q(c.open),...d,ref:p,onDismiss:()=>c.onOpenChange(!1)})}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q,{titleId:c.titleId}),(0,r.jsx)(ee,{contentRef:u,descriptionId:c.descriptionId})]})]})}),G="DialogTitle",H=l.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,o=E(G,n);return(0,r.jsx)(x.Primitive.h2,{id:o.titleId,...a,ref:t})});H.displayName=G;var V="DialogDescription",z=l.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,o=E(V,n);return(0,r.jsx)(x.Primitive.p,{id:o.descriptionId,...a,ref:t})});z.displayName=V;var Z="DialogClose",K=l.forwardRef((e,t)=>{let{__scopeDialog:n,...a}=e,o=E(Z,n);return(0,r.jsx)(x.Primitive.button,{type:"button",...a,ref:t,onClick:(0,i.composeEventHandlers)(e.onClick,()=>o.onOpenChange(!1))})});function q(e){return e?"open":"closed"}K.displayName=Z;var Y="DialogTitleWarning",[X,J]=(0,d.createContext)(Y,{contentName:F,titleName:G,docsSlug:"dialog"}),Q=({titleId:e})=>{let t=J(Y),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return l.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},ee=({contentRef:e,descriptionId:t})=>{let n=J("DialogDescriptionWarning"),a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${n.contentName}}.`;return l.useEffect(()=>{let n=e.current?.getAttribute("aria-describedby");t&&n&&(document.getElementById(t)||console.warn(a))},[a,e,t]),null};let et=(0,e.i(65756).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["default",()=>et],32977);var en=e.i(67830);function ea(e){let t,n,a=(0,o.c)(4);return a[0]!==e?({...t}=e,a[0]=e,a[1]=t):t=a[1],a[2]!==t?(n=(0,r.jsx)(R,{"data-slot":"dialog",...t}),a[2]=t,a[3]=n):n=a[3],n}function er(e){let t,n,a=(0,o.c)(4);return a[0]!==e?({...t}=e,a[0]=e,a[1]=t):t=a[1],a[2]!==t?(n=(0,r.jsx)(P,{"data-slot":"dialog-trigger",...t}),a[2]=t,a[3]=n):n=a[3],n}function eo(e){let t,n,a=(0,o.c)(4);return a[0]!==e?({...t}=e,a[0]=e,a[1]=t):t=a[1],a[2]!==t?(n=(0,r.jsx)(I,{"data-slot":"dialog-portal",...t}),a[2]=t,a[3]=n):n=a[3],n}function el(e){let t,n,a,l,i=(0,o.c)(8);return i[0]!==e?({className:t,...n}=e,i[0]=e,i[1]=t,i[2]=n):(t=i[1],n=i[2]),i[3]!==t?(a=(0,en.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),i[3]=t,i[4]=a):a=i[4],i[5]!==n||i[6]!==a?(l=(0,r.jsx)(T,{"data-slot":"dialog-overlay",className:a,...n}),i[5]=n,i[6]=a,i[7]=l):l=i[7],l}function ei(e){let t,n,a,l,i,s,d,c,u=(0,o.c)(15);u[0]!==e?({className:n,children:t,showCloseButton:l,...a}=e,u[0]=e,u[1]=t,u[2]=n,u[3]=a,u[4]=l):(t=u[1],n=u[2],a=u[3],l=u[4]);let m=void 0===l||l;return u[5]===Symbol.for("react.memo_cache_sentinel")?(i=(0,r.jsx)(el,{}),u[5]=i):i=u[5],u[6]!==n?(s=(0,en.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",n),u[6]=n,u[7]=s):s=u[7],u[8]!==m?(d=m&&(0,r.jsxs)(K,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(et,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]}),u[8]=m,u[9]=d):d=u[9],u[10]!==t||u[11]!==a||u[12]!==s||u[13]!==d?(c=(0,r.jsxs)(eo,{"data-slot":"dialog-portal",children:[i,(0,r.jsxs)(U,{"data-slot":"dialog-content",className:s,...a,children:[t,d]})]}),u[10]=t,u[11]=a,u[12]=s,u[13]=d,u[14]=c):c=u[14],c}function es(e){let t,n,a,l,i=(0,o.c)(8);return i[0]!==e?({className:t,...n}=e,i[0]=e,i[1]=t,i[2]=n):(t=i[1],n=i[2]),i[3]!==t?(a=(0,en.cn)("flex flex-col gap-2 text-center sm:text-left",t),i[3]=t,i[4]=a):a=i[4],i[5]!==n||i[6]!==a?(l=(0,r.jsx)("div",{"data-slot":"dialog-header",className:a,...n}),i[5]=n,i[6]=a,i[7]=l):l=i[7],l}function ed(e){let t,n,a,l,i=(0,o.c)(8);return i[0]!==e?({className:t,...n}=e,i[0]=e,i[1]=t,i[2]=n):(t=i[1],n=i[2]),i[3]!==t?(a=(0,en.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),i[3]=t,i[4]=a):a=i[4],i[5]!==n||i[6]!==a?(l=(0,r.jsx)("div",{"data-slot":"dialog-footer",className:a,...n}),i[5]=n,i[6]=a,i[7]=l):l=i[7],l}function ec(e){let t,n,a,l,i=(0,o.c)(8);return i[0]!==e?({className:t,...n}=e,i[0]=e,i[1]=t,i[2]=n):(t=i[1],n=i[2]),i[3]!==t?(a=(0,en.cn)("text-lg leading-none font-semibold",t),i[3]=t,i[4]=a):a=i[4],i[5]!==n||i[6]!==a?(l=(0,r.jsx)(H,{"data-slot":"dialog-title",className:a,...n}),i[5]=n,i[6]=a,i[7]=l):l=i[7],l}function eu(e){let t,n,a,l,i=(0,o.c)(8);return i[0]!==e?({className:t,...n}=e,i[0]=e,i[1]=t,i[2]=n):(t=i[1],n=i[2]),i[3]!==t?(a=(0,en.cn)("text-muted-foreground text-sm",t),i[3]=t,i[4]=a):a=i[4],i[5]!==n||i[6]!==a?(l=(0,r.jsx)(z,{"data-slot":"dialog-description",className:a,...n}),i[5]=n,i[6]=a,i[7]=l):l=i[7],l}e.s(["Dialog",()=>ea,"DialogContent",()=>ei,"DialogDescription",()=>eu,"DialogFooter",()=>ed,"DialogHeader",()=>es,"DialogTitle",()=>ec,"DialogTrigger",()=>er],34219)},26886,e=>{"use strict";var t=e.i(73444),n=e.i(74907),a=e.i(7272),r=e.i(63835),o=e.i(12286),l=e.i(34219);function i(){let{db:i,setDb:s,currentDbName:d,setCurrentDbName:c}=(0,a.useDatabaseStore)(),[u,m]=(0,n.useState)(null),f=i||u,[p,g]=(0,n.useState)([]),[x,h]=(0,n.useState)([]),[v,y]=(0,n.useState)(!0),[w,b]=(0,n.useState)(!1),[j,N]=(0,n.useState)(""),[D,C]=(0,n.useState)(1),[E,R]=(0,n.useState)(null),[k,P]=(0,n.useState)([]),[O,S]=(0,n.useState)(!1),A=(0,n.useRef)(null);(0,n.useEffect)(()=>{!async function(){try{let{Database:t}=await e.A(61419);if(window.Database=t,i){window.testDb=i;return}let n=(await e.A(61419)).default;await n()}catch(e){console.error("Failed to initialize WASM:",e)}}()},[i]),(0,n.useEffect)(()=>{let e=()=>{let e=window.testDb;e&&!u&&(console.log("[DiagramPage] Detected window.testDb, updating state"),m(e))};e();let t=setInterval(e,50);return()=>clearInterval(t)},[u]),(0,n.useEffect)(()=>{f&&I()},[f]);let I=async()=>{if(f){b(!0),N("");try{let e=(await i.execute("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%' ORDER BY name")).rows.map(e=>e.values[0].value),t=[],n=[];for(let a=0;a<e.length;a++){let r=e[a],o=(await i.execute(`PRAGMA table_info(${r})`)).rows.length;for(let e of(await i.execute(`PRAGMA foreign_key_list(${r})`)).rows){let t=e.values[2].value,a=e.values[3].value,o=e.values[4].value;n.push({from:r,to:t,fromColumn:a,toColumn:o})}let l=Math.ceil(Math.sqrt(e.length)),s=Math.floor(a/l),d=a%l;t.push({name:r,columnCount:o,x:50+250*d,y:50+150*s})}g(t),h(n)}catch(e){console.error("[DiagramPage] Error loading diagram:",e),N(`Failed to load diagram: ${e}`)}finally{b(!1)}}};(0,n.useEffect)(()=>{window.loadDiagram=I},[i]);let _=async e=>{if(f)try{let t=(await i.execute(`PRAGMA table_info(${e})`)).rows.map(e=>({name:e.values[1].value,type:e.values[2].value,notnull:1===e.values[3].value,dflt_value:e.values[4].value,pk:1===e.values[5].value}));P(t),R(e)}catch(e){console.error("[DiagramPage] Error loading table details:",e)}},T=async()=>{if(A.current)try{console.log("[DiagramPage] Starting PNG export");let t=(await e.A(20360)).default;console.log("[DiagramPage] html2canvas loaded, rendering canvas");let n=await t(A.current,{backgroundColor:"#ffffff",logging:!1,scale:2});console.log("[DiagramPage] Canvas rendered, creating download");let a=n.toDataURL("image/png"),r=document.createElement("a");r.download=`er-diagram-${Date.now()}.png`,r.href=a,document.body.appendChild(r),r.click(),document.body.removeChild(r),console.log("[DiagramPage] PNG export complete")}catch(e){console.error("[DiagramPage] Error exporting PNG:",e),N(`Failed to export PNG: ${e}`)}};return v?(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("p",{children:"Initializing database..."})}):(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"ER Diagram"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:[p.length," ",1===p.length?"table":"tables",", ",x.length," ",1===x.length?"relationship":"relationships"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>{C(e=>Math.max(e-.2,.2))},children:"Zoom Out"}),(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>{C(1)},children:"Reset Zoom"}),(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>{C(e=>Math.min(e+.2,3))},children:"Zoom In"}),(0,t.jsx)(r.Button,{onClick:()=>S(!0),children:"Export"})]})]}),j&&(0,t.jsx)("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded","data-testid":"error-message",children:j}),0===p.length?(0,t.jsx)(o.Card,{className:"p-8 text-center",children:(0,t.jsx)("p",{className:"text-muted-foreground",children:"No tables found in the database. Create tables to see the ER diagram."})}):(0,t.jsx)("div",{className:"border rounded-lg overflow-auto",style:{height:"calc(100vh - 250px)"},children:(0,t.jsxs)("div",{ref:A,"data-testid":"diagram-container",style:{transform:`scale(${D})`,transformOrigin:"top left",transition:"transform 0.2s",width:"1200px",height:"800px",position:"relative",padding:"20px"},children:[(0,t.jsxs)("svg",{width:"1200",height:"800",style:{position:"absolute",top:0,left:0,pointerEvents:"none",overflow:"visible",visibility:"visible"},viewBox:"0 0 1200 800",children:[(0,t.jsx)("defs",{children:(0,t.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",children:(0,t.jsx)("polygon",{points:"0 0, 10 3, 0 6",fill:"#666"})})}),x.map((e,n)=>{let a=p.find(t=>t.name===e.from),r=p.find(t=>t.name===e.to);return a&&r?(0,t.jsx)("line",{"data-edge-type":"foreign-key","data-fk-edge":`${e.from}->${e.to}`,x1:a.x+100,y1:a.y+60,x2:r.x+100,y2:r.y+60,stroke:"#666",strokeWidth:"2",markerEnd:"url(#arrowhead)",style:{visibility:"visible",display:"inline"}},n):null})]}),p.map(e=>(0,t.jsxs)("div",{"data-node-type":"table","data-table-node":e.name,onClick:()=>_(e.name),style:{position:"absolute",left:e.x,top:e.y,width:"200px",cursor:"pointer"},className:"bg-white border-2 border-gray-300 rounded-lg p-4 shadow-md hover:shadow-lg transition-shadow",children:[(0,t.jsx)("div",{className:"font-bold text-center",children:e.name}),(0,t.jsxs)("div",{className:"text-sm text-gray-500 text-center mt-1",children:[e.columnCount," columns"]})]},e.name))]})}),(0,t.jsx)(l.Dialog,{open:null!==E,onOpenChange:e=>!e&&R(null),children:(0,t.jsxs)(l.DialogContent,{children:[(0,t.jsxs)(l.DialogHeader,{children:[(0,t.jsx)(l.DialogTitle,{children:E}),(0,t.jsx)(l.DialogDescription,{children:"Table structure and columns"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Columns:"}),(0,t.jsx)("div",{className:"border rounded",children:k.map((e,n)=>(0,t.jsxs)("div",{className:"px-3 py-2 border-b last:border-b-0",children:[(0,t.jsx)("span",{className:"font-mono font-semibold",children:e.name}),(0,t.jsxs)("span",{className:"text-gray-500 ml-2",children:["(",e.type,")"]}),e.pk&&(0,t.jsx)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded",children:"PK"}),e.notnull&&(0,t.jsx)("span",{className:"ml-1 text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded",children:"NOT NULL"})]},n))})]}),(0,t.jsx)(l.DialogFooter,{children:(0,t.jsx)(r.Button,{onClick:()=>R(null),children:"Close"})})]})}),(0,t.jsx)(l.Dialog,{open:O,onOpenChange:S,children:(0,t.jsxs)(l.DialogContent,{children:[(0,t.jsxs)(l.DialogHeader,{children:[(0,t.jsx)(l.DialogTitle,{children:"Export Diagram"}),(0,t.jsx)(l.DialogDescription,{children:"Choose export format"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(r.Button,{className:"w-full",onClick:()=>{T(),S(!1)},children:"Export as PNG"}),(0,t.jsx)(r.Button,{className:"w-full",variant:"outline",onClick:()=>{if(A.current)try{console.log("[DiagramPage] Starting SVG export");let e=`<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="800">
  <style>
    .table-node { fill: white; stroke: #ccc; stroke-width: 2; }
    .table-text { font-family: Arial; font-size: 14px; }
    .edge { stroke: #666; stroke-width: 2; marker-end: url(#arrowhead); }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#666" />
    </marker>
  </defs>
`;x.forEach(t=>{let n=p.find(e=>e.name===t.from),a=p.find(e=>e.name===t.to);n&&a&&(e+=`  <line class="edge" x1="${n.x+100}" y1="${n.y+60}" x2="${a.x+100}" y2="${a.y+60}" />
`)}),p.forEach(t=>{e+=`  <rect class="table-node" x="${t.x}" y="${t.y}" width="200" height="80" rx="5" />
  <text class="table-text" x="${t.x+100}" y="${t.y+35}" text-anchor="middle" font-weight="bold">${t.name}</text>
  <text class="table-text" x="${t.x+100}" y="${t.y+55}" text-anchor="middle" font-size="12">${t.columnCount} columns</text>
`}),e+="</svg>",console.log("[DiagramPage] SVG content created, creating download");let t=new Blob([e],{type:"image/svg+xml"}),n=URL.createObjectURL(t),a=document.createElement("a");a.download=`er-diagram-${Date.now()}.svg`,a.href=n,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n),console.log("[DiagramPage] SVG export complete")}catch(e){console.error("[DiagramPage] Error exporting SVG:",e),N(`Failed to export SVG: ${e}`)}S(!1)},children:"Export as SVG"})]}),(0,t.jsx)(l.DialogFooter,{children:(0,t.jsx)(r.Button,{variant:"outline",onClick:()=>S(!1),children:"Cancel"})})]})})]})}e.s(["default",()=>i])},61419,e=>{e.v(t=>Promise.all(["static/chunks/0d126131a3369877.js"].map(t=>e.l(t))).then(()=>t(4948)))},20360,e=>{e.v(t=>Promise.all(["static/chunks/26ff52123034819a.js"].map(t=>e.l(t))).then(()=>t(99848)))}]);