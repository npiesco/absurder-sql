(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40633,e=>{"use strict";var t=e.i(73444),r=e.i(75784),a=e.i(67830);function i(e){let i,s,l,n,o=(0,r.c)(8);return o[0]!==e?({className:i,...s}=e,o[0]=e,o[1]=i,o[2]=s):(i=o[1],s=o[2]),o[3]!==i?(l=(0,a.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),o[3]=i,o[4]=l):l=o[4],o[5]!==s||o[6]!==l?(n=(0,t.jsx)("textarea",{"data-slot":"textarea",className:l,...s}),o[5]=s,o[6]=l,o[7]=n):n=o[7],n}e.s(["Textarea",()=>i])},65756,e=>{"use strict";var t=e.i(74907);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:n="",children:o,iconNode:c,...d},u)=>(0,t.createElement)("svg",{ref:u,...i,width:r,height:r,stroke:e,strokeWidth:l?24*Number(s)/Number(r):s,className:a("lucide",n),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),l=(e,i)=>{let l=(0,t.forwardRef)(({className:l,...n},o)=>(0,t.createElement)(s,{ref:o,iconNode:i,className:a(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,l),...n}));return l.displayName=r(e),l};e.s(["default",()=>l],65756)},67608,e=>{"use strict";var t=e.i(73444),r=e.i(75784),a=e.i(67830);function i(e){let i,s,l,n,o,c=(0,r.c)(10);return c[0]!==e?({className:i,type:l,...s}=e,c[0]=e,c[1]=i,c[2]=s,c[3]=l):(i=c[1],s=c[2],l=c[3]),c[4]!==i?(n=(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",i),c[4]=i,c[5]=n):n=c[5],c[6]!==s||c[7]!==n||c[8]!==l?(o=(0,t.jsx)("input",{type:l,"data-slot":"input",className:n,...s}),c[6]=s,c[7]=n,c[8]=l,c[9]=o):o=c[9],o}e.s(["Input",()=>i])},91414,e=>{"use strict";var t=e.i(73444),r=e.i(75784),a=e.i(74907);e.i(39584);var i=e.i(10836),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let s=(0,i.createSlot)(`Primitive.${r}`),l=a.forwardRef((e,a)=>{let{asChild:i,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(i?s:r,{...l,ref:a})});return l.displayName=`Primitive.${r}`,{...e,[r]:l}},{}),l=a.forwardRef((e,r)=>(0,t.jsx)(s.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var n=e.i(67830);function o(e){let a,i,s,o,c=(0,r.c)(8);return c[0]!==e?({className:a,...i}=e,c[0]=e,c[1]=a,c[2]=i):(a=c[1],i=c[2]),c[3]!==a?(s=(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),c[3]=a,c[4]=s):s=c[4],c[5]!==i||c[6]!==s?(o=(0,t.jsx)(l,{"data-slot":"label",className:s,...i}),c[5]=i,c[6]=s,c[7]=o):o=c[7],o}e.s(["Label",()=>o],91414)},77393,e=>{"use strict";var t=e.i(73444),r=e.i(75784),a=e.i(74907),i=e.i(7272),s=e.i(63835),l=e.i(12286),n=e.i(67608),o=e.i(91414),c=e.i(72667),d=e.i(95706),u=e.i(43330),h=e.i(64587),x=e.i(75871),m=e.i(18709),p=e.i(79969),f=e.i(25490),g=e.i(48098),j=e.i(25473),v=e.i(80651),b=e.i(98618),y=e.i(82706),C=e.i(22915),w=e.i(26451),S=e.i(71689),L=e.i(40633);let N=["#2563eb","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#14b8a6","#f97316"];function k(){let{db:r}=(0,i.useDatabaseStore)(),k=(0,i.useDatabaseStore)(e=>e.currentDbName),[R,T]=(0,a.useState)("SELECT * FROM your_table"),[A,D]=(0,a.useState)(null),[E,B]=(0,a.useState)(null),[U,_]=(0,a.useState)(!1),[P,z]=(0,a.useState)("line"),[O,$]=(0,a.useState)(""),[K,F]=(0,a.useState)(""),[q,G]=(0,a.useState)(""),[I,Q]=(0,a.useState)([]),[V,M]=(0,a.useState)([]),X=(0,a.useRef)(null),[W,H]=(0,a.useState)(null),Y=r||W;(0,a.useEffect)(()=>{!async function(){try{let{Database:t}=await e.A(61419);if(window.Database=t,r){window.testDb=r;return}let a=(await e.A(61419)).default;await a()}catch(e){console.error("Failed to initialize WASM:",e)}}()},[r]),(0,a.useEffect)(()=>{let e=()=>{let e=window.testDb;e&&!W&&(console.log("[CHARTS] Detected window.testDb, updating state"),H(e))};e();let t=setInterval(e,50);return()=>clearInterval(t)},[W]);let Z=async()=>{if(!Y)return void B("Database not initialized");if(!R.trim())return void B("Please enter a SQL query");_(!0),B(null);try{let e=await Y.execute(R);if(D(e),B(null),e.columns&&e.columns.length>0){let t=e.columns;M(t),!K&&t.length>0&&F(t[0]),!q&&t.length>1?G(t[1]):!q&&t.length>0&&G(t[0]);let r=e.rows.map((t,r)=>{let a={_index:r};return e.columns.forEach((e,r)=>{var i;let s=(i=t.values[r],"Null"===i.type?null:i.value);a[e]=s}),a});Q(r)}else Q([]),M([])}catch(e){console.error("Query execution error:",e),B(`Query failed: ${String(e)}`),D(null),Q([])}finally{_(!1)}},J=async()=>{if(!X.current)return void console.error("[PNG Export] Chart container ref not found");try{let e=X.current.querySelector("svg");if(!e)return;let t=e.getBoundingClientRect(),r=document.createElement("canvas");r.width=2*t.width,r.height=2*t.height;let a=r.getContext("2d");if(!a)return;a.fillStyle="#ffffff",a.fillRect(0,0,r.width,r.height);let i=new XMLSerializer().serializeToString(e),s=new Blob([i],{type:"image/svg+xml;charset=utf-8"}),l=URL.createObjectURL(s),n=new Image;n.onload=()=>{a.drawImage(n,0,0,r.width,r.height),URL.revokeObjectURL(l);let e=r.toDataURL("image/png"),t=document.createElement("a");t.download=O?`${O.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_chart.png`:"chart.png",t.href=e,t.click()},n.onerror=()=>{URL.revokeObjectURL(l)},n.src=l}catch(e){console.error("PNG export error:",e)}};return k&&Y?(0,t.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{children:[(0,t.jsx)(l.CardTitle,{children:"Chart Builder"}),(0,t.jsx)(l.CardDescription,{children:"Create interactive charts from your SQL queries"})]}),(0,t.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{htmlFor:"sqlQuery",children:"SQL Query"}),(0,t.jsx)(L.Textarea,{id:"sqlQuery",placeholder:"SELECT column1, column2 FROM your_table",value:R,onChange:e=>T(e.target.value),rows:4,className:"font-mono text-sm"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(s.Button,{onClick:Z,disabled:!R.trim()||U,children:U?"Executing...":"Execute"}),A&&(0,t.jsx)(s.Button,{variant:"outline",onClick:()=>{D(null),Q([]),B(null)},children:"Clear"})]}),E&&(0,t.jsx)("div",{className:"text-red-600 text-sm",children:E}),A&&0===A.rows.length&&(0,t.jsx)("div",{className:"text-muted-foreground text-sm",children:"No results returned from query"})]})]}),A&&I.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsx)(l.CardTitle,{children:"Chart Configuration"})}),(0,t.jsxs)(l.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{htmlFor:"chartType",children:"Chart Type"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(s.Button,{variant:"line"===P?"default":"outline",onClick:()=>z("line"),"data-testid":"chart-type-line",children:"Line"}),(0,t.jsx)(s.Button,{variant:"bar"===P?"default":"outline",onClick:()=>z("bar"),"data-testid":"chart-type-bar",children:"Bar"}),(0,t.jsx)(s.Button,{variant:"pie"===P?"default":"outline",onClick:()=>z("pie"),"data-testid":"chart-type-pie",children:"Pie"}),(0,t.jsx)(s.Button,{variant:"scatter"===P?"default":"outline",onClick:()=>z("scatter"),"data-testid":"chart-type-scatter",children:"Scatter"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{htmlFor:"chartTitle",children:"Chart Title"}),(0,t.jsx)(n.Input,{id:"chartTitle",placeholder:"Enter chart title",value:O,onChange:e=>$(e.target.value)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{htmlFor:"xAxis",children:"X-Axis Column"}),(0,t.jsxs)(c.Select,{value:K,onValueChange:F,children:[(0,t.jsx)(c.SelectTrigger,{id:"xAxis","data-testid":"x-axis-selector",children:(0,t.jsx)(c.SelectValue,{placeholder:"Select column"})}),(0,t.jsx)(c.SelectContent,{children:V.map(e=>(0,t.jsx)(c.SelectItem,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.Label,{htmlFor:"yAxis",children:"Y-Axis Column"}),(0,t.jsxs)(c.Select,{value:q,onValueChange:G,children:[(0,t.jsx)(c.SelectTrigger,{id:"yAxis","data-testid":"y-axis-selector",children:(0,t.jsx)(c.SelectValue,{placeholder:"Select column"})}),(0,t.jsx)(c.SelectContent,{children:V.map(e=>(0,t.jsx)(c.SelectItem,{value:e,children:e},e))})]})]})]})]})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{children:[(0,t.jsx)(l.CardTitle,{children:O||"Chart Preview"}),(0,t.jsx)(l.CardDescription,{children:(0,t.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:J,"data-testid":"export-png",children:"Export PNG"}),(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:()=>{if(X.current)try{let e=X.current.querySelector("svg");if(!e)return;let t=new XMLSerializer().serializeToString(e),r=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),a=URL.createObjectURL(r),i=document.createElement("a");i.download=O?`${O.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_chart.svg`:"chart.svg",i.href=a,i.click(),URL.revokeObjectURL(a)}catch(e){console.error("SVG export error:",e)}},"data-testid":"export-svg",children:"Export SVG"}),(0,t.jsx)(s.Button,{variant:"outline",size:"sm",onClick:()=>{if(I&&0!==I.length)try{let e=Object.keys(I[0]).filter(e=>"_index"!==e),t=[e.join(",")];I.forEach(r=>{let a=e.map(e=>{let t=r[e];return"string"==typeof t&&(t.includes(",")||t.includes('"'))?`"${t.replace(/"/g,'""')}"`:t});t.push(a.join(","))});let r=t.join("\n"),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(a),s=document.createElement("a");s.download=O?`${O.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_data.csv`:"chart_data.csv",s.href=i,s.click(),URL.revokeObjectURL(i)}catch(e){console.error("CSV export error:",e)}},"data-testid":"export-csv",children:"Download CSV"})]})})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("div",{"data-testid":"chart-preview",ref:X,style:{backgroundColor:"#ffffff",padding:"1rem"},children:(()=>{if(!I||0===I.length)return(0,t.jsx)("div",{className:"flex items-center justify-center h-64 text-muted-foreground",children:(0,t.jsx)("p",{children:"No data to display. Execute a query to see results."})});switch(P){case"line":return(0,t.jsx)(w.ResponsiveContainer,{width:"100%",height:400,children:(0,t.jsxs)(d.LineChart,{data:I,children:[(0,t.jsx)(b.CartesianGrid,{strokeDasharray:"3 3"}),(0,t.jsx)(j.XAxis,{dataKey:K||V[0]}),(0,t.jsx)(v.YAxis,{}),(0,t.jsx)(y.Tooltip,{}),(0,t.jsx)(C.Legend,{}),(0,t.jsx)(u.Line,{type:"monotone",dataKey:q||V[1],stroke:"#2563eb",strokeWidth:2})]})});case"bar":return(0,t.jsx)(w.ResponsiveContainer,{width:"100%",height:400,children:(0,t.jsxs)(h.BarChart,{data:I,children:[(0,t.jsx)(b.CartesianGrid,{strokeDasharray:"3 3"}),(0,t.jsx)(j.XAxis,{dataKey:K||V[0]}),(0,t.jsx)(v.YAxis,{}),(0,t.jsx)(y.Tooltip,{}),(0,t.jsx)(C.Legend,{}),(0,t.jsx)(x.Bar,{dataKey:q||V[1],fill:"#2563eb"})]})});case"pie":return(0,t.jsx)(w.ResponsiveContainer,{width:"100%",height:400,children:(0,t.jsxs)(m.PieChart,{children:[(0,t.jsx)(p.Pie,{data:I,dataKey:q||V[1],nameKey:K||V[0],cx:"50%",cy:"50%",outerRadius:120,label:!0,children:I.map((e,r)=>(0,t.jsx)(S.Cell,{fill:N[r%N.length]},`cell-${r}`))}),(0,t.jsx)(y.Tooltip,{}),(0,t.jsx)(C.Legend,{})]})});case"scatter":return(0,t.jsx)(w.ResponsiveContainer,{width:"100%",height:400,children:(0,t.jsxs)(f.ScatterChart,{children:[(0,t.jsx)(b.CartesianGrid,{strokeDasharray:"3 3"}),(0,t.jsx)(j.XAxis,{dataKey:K||V[0]}),(0,t.jsx)(v.YAxis,{dataKey:q||V[1]}),(0,t.jsx)(y.Tooltip,{cursor:{strokeDasharray:"3 3"}}),(0,t.jsx)(C.Legend,{}),(0,t.jsx)(g.Scatter,{name:"Data Points",data:I,fill:"#2563eb"})]})});default:return null}})()})})]})]})]}):(0,t.jsx)("div",{className:"container mx-auto p-6",children:(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"pt-6",children:(0,t.jsx)("p",{children:"No database selected. Please create or load a database first."})})})})}function R(){let e,a=(0,r.c)(1);return(0,i.useDatabaseStore)(T),a[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)(k,{}),a[0]=e):e=a[0],e}function T(e){return e.currentDbName}e.s(["default",()=>R])},61419,e=>{e.v(t=>Promise.all(["static/chunks/0d126131a3369877.js"].map(t=>e.l(t))).then(()=>t(4948)))}]);