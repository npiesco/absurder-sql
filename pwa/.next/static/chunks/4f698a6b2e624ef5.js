(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67608,e=>{"use strict";var t=e.i(73444),r=e.i(75784),i=e.i(67830);function n(e){let n,a,s,o,l,d=(0,r.c)(10);return d[0]!==e?({className:n,type:s,...a}=e,d[0]=e,d[1]=n,d[2]=a,d[3]=s):(n=d[1],a=d[2],s=d[3]),d[4]!==n?(o=(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),d[4]=n,d[5]=o):o=d[5],d[6]!==a||d[7]!==o||d[8]!==s?(l=(0,t.jsx)("input",{type:s,"data-slot":"input",className:o,...a}),d[6]=a,d[7]=o,d[8]=s,d[9]=l):l=d[9],l}e.s(["Input",()=>n])},65756,e=>{"use strict";var t=e.i(74907);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},i=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:o="",children:l,iconNode:d,...c},u)=>(0,t.createElement)("svg",{ref:u,...n,width:r,height:r,stroke:e,strokeWidth:s?24*Number(a)/Number(r):a,className:i("lucide",o),...!l&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(l)?l:[l]])),s=(e,n)=>{let s=(0,t.forwardRef)(({className:s,...o},l)=>(0,t.createElement)(a,{ref:l,iconNode:n,className:i(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...o}));return s.displayName=r(e),s};e.s(["default",()=>s],65756)},33690,e=>{"use strict";var t=e.i(74907),r=e.i(69617),i=e.i(9486),n=e=>{var n;let s,o,{present:l,children:d}=e,c=function(e){var r,n;let[s,o]=t.useState(),l=t.useRef(null),d=t.useRef(e),c=t.useRef("none"),[u,g]=(r=e?"mounted":"unmounted",n={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>n[e][t]??e,r));return t.useEffect(()=>{let e=a(l.current);c.current="mounted"===u?e:"none"},[u]),(0,i.useLayoutEffect)(()=>{let t=l.current,r=d.current;if(r!==e){let i=c.current,n=a(t);e?g("MOUNT"):"none"===n||t?.display==="none"?g("UNMOUNT"):r&&i!==n?g("ANIMATION_OUT"):g("UNMOUNT"),d.current=e}},[e,g]),(0,i.useLayoutEffect)(()=>{if(s){let e,t=s.ownerDocument.defaultView??window,r=r=>{let i=a(l.current).includes(CSS.escape(r.animationName));if(r.target===s&&i&&(g("ANIMATION_END"),!d.current)){let r=s.style.animationFillMode;s.style.animationFillMode="forwards",e=t.setTimeout(()=>{"forwards"===s.style.animationFillMode&&(s.style.animationFillMode=r)})}},i=e=>{e.target===s&&(c.current=a(l.current))};return s.addEventListener("animationstart",i),s.addEventListener("animationcancel",r),s.addEventListener("animationend",r),()=>{t.clearTimeout(e),s.removeEventListener("animationstart",i),s.removeEventListener("animationcancel",r),s.removeEventListener("animationend",r)}}g("ANIMATION_END")},[s,g]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:t.useCallback(e=>{l.current=e?getComputedStyle(e):null,o(e)},[])}}(l),u="function"==typeof d?d({present:c.isPresent}):t.Children.only(d),g=(0,r.useComposedRefs)(c.ref,(n=u,(o=(s=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in s&&s.isReactWarning)?n.ref:(o=(s=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in s&&s.isReactWarning)?n.props.ref:n.props.ref||n.ref));return"function"==typeof d||c.isPresent?t.cloneElement(u,{ref:g}):null};function a(e){return e?.animationName||"none"}n.displayName="Presence",e.s(["Presence",()=>n])},34219,32977,e=>{"use strict";let t,r,i;var n=e.i(73444),a=e.i(75784),s=e.i(74907),o=e.i(35560),l=e.i(69617),d=e.i(26972),c=e.i(37707),u=e.i(29275),g=e.i(54215),m=e.i(30398),f=e.i(53711),p=e.i(33690),x=e.i(67329),h=e.i(77329),v=e.i(76283),b=e.i(60567),j=Symbol("radix.slottable");function T(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===j}var E="Dialog",[N,y]=(0,d.createContextScope)(E),[w,C]=N(E),D=e=>{let{__scopeDialog:t,children:r,open:i,defaultOpen:a,onOpenChange:o,modal:l=!0}=e,d=s.useRef(null),g=s.useRef(null),[m,f]=(0,u.useControllableState)({prop:i,defaultProp:a??!1,onChange:o,caller:E});return(0,n.jsx)(w,{scope:t,triggerRef:d,contentRef:g,contentId:(0,c.useId)(),titleId:(0,c.useId)(),descriptionId:(0,c.useId)(),open:m,onOpenChange:f,onOpenToggle:s.useCallback(()=>f(e=>!e),[f]),modal:l,children:r})};D.displayName=E;var R="DialogTrigger",S=s.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,a=C(R,r),s=(0,l.useComposedRefs)(t,a.triggerRef);return(0,n.jsx)(x.Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":K(a.open),...i,ref:s,onClick:(0,o.composeEventHandlers)(e.onClick,a.onOpenToggle)})});S.displayName=R;var O="DialogPortal",[I,F]=N(O,{forceMount:void 0}),P=e=>{let{__scopeDialog:t,forceMount:r,children:i,container:a}=e,o=C(O,t);return(0,n.jsx)(I,{scope:t,forceMount:r,children:s.Children.map(i,e=>(0,n.jsx)(p.Presence,{present:r||o.open,children:(0,n.jsx)(f.Portal,{asChild:!0,container:a,children:e})}))})};P.displayName=O;var A="DialogOverlay",_=s.forwardRef((e,t)=>{let r=F(A,e.__scopeDialog),{forceMount:i=r.forceMount,...a}=e,s=C(A,e.__scopeDialog);return s.modal?(0,n.jsx)(p.Presence,{present:i||s.open,children:(0,n.jsx)(B,{...a,ref:t})}):null});_.displayName=A;var L=((i=s.forwardRef((e,t)=>{let{children:r,...i}=e;if(s.isValidElement(r)){var n;let e,a,o=(n=r,(a=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(a=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),d=function(e,t){let r={...t};for(let i in t){let n=e[i],a=t[i];/^on[A-Z]/.test(i)?n&&a?r[i]=(...e)=>{let t=a(...e);return n(...e),t}:n&&(r[i]=n):"style"===i?r[i]={...n,...a}:"className"===i&&(r[i]=[n,a].filter(Boolean).join(" "))}return{...e,...r}}(i,r.props);return r.type!==s.Fragment&&(d.ref=t?(0,l.composeRefs)(t,o):o),s.cloneElement(r,d)}return s.Children.count(r)>1?s.Children.only(null):null})).displayName="DialogOverlay.RemoveScroll.SlotClone",t=i,(r=s.forwardRef((e,r)=>{let{children:i,...a}=e,o=s.Children.toArray(i),l=o.find(T);if(l){let e=l.props.children,i=o.map(t=>t!==l?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,n.jsx)(t,{...a,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,i):null})}return(0,n.jsx)(t,{...a,ref:r,children:i})})).displayName="DialogOverlay.RemoveScroll.Slot",r),B=s.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,a=C(A,r);return(0,n.jsx)(v.RemoveScroll,{as:L,allowPinchZoom:!0,shards:[a.contentRef],children:(0,n.jsx)(x.Primitive.div,{"data-state":K(a.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),k="DialogContent",$=s.forwardRef((e,t)=>{let r=F(k,e.__scopeDialog),{forceMount:i=r.forceMount,...a}=e,s=C(k,e.__scopeDialog);return(0,n.jsx)(p.Presence,{present:i||s.open,children:s.modal?(0,n.jsx)(M,{...a,ref:t}):(0,n.jsx)(U,{...a,ref:t})})});$.displayName=k;var M=s.forwardRef((e,t)=>{let r=C(k,e.__scopeDialog),i=s.useRef(null),a=(0,l.useComposedRefs)(t,r.contentRef,i);return s.useEffect(()=>{let e=i.current;if(e)return(0,b.hideOthers)(e)},[]),(0,n.jsx)(G,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:(0,o.composeEventHandlers)(e.onCloseAutoFocus,e=>{e.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:(0,o.composeEventHandlers)(e.onPointerDownOutside,e=>{let t=e.detail.originalEvent,r=0===t.button&&!0===t.ctrlKey;(2===t.button||r)&&e.preventDefault()}),onFocusOutside:(0,o.composeEventHandlers)(e.onFocusOutside,e=>e.preventDefault())})}),U=s.forwardRef((e,t)=>{let r=C(k,e.__scopeDialog),i=s.useRef(!1),a=s.useRef(!1);return(0,n.jsx)(G,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{e.onCloseAutoFocus?.(t),t.defaultPrevented||(i.current||r.triggerRef.current?.focus(),t.preventDefault()),i.current=!1,a.current=!1},onInteractOutside:t=>{e.onInteractOutside?.(t),t.defaultPrevented||(i.current=!0,"pointerdown"===t.detail.originalEvent.type&&(a.current=!0));let n=t.target;r.triggerRef.current?.contains(n)&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&a.current&&t.preventDefault()}})}),G=s.forwardRef((e,t)=>{let{__scopeDialog:r,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:o,...d}=e,c=C(k,r),u=s.useRef(null),f=(0,l.useComposedRefs)(t,u);return(0,h.useFocusGuards)(),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.FocusScope,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:a,onUnmountAutoFocus:o,children:(0,n.jsx)(g.DismissableLayer,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":K(c.open),...d,ref:f,onDismiss:()=>c.onOpenChange(!1)})}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(X,{titleId:c.titleId}),(0,n.jsx)(ee,{contentRef:u,descriptionId:c.descriptionId})]})]})}),W="DialogTitle",q=s.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,a=C(W,r);return(0,n.jsx)(x.Primitive.h2,{id:a.titleId,...i,ref:t})});q.displayName=W;var z="DialogDescription",H=s.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,a=C(z,r);return(0,n.jsx)(x.Primitive.p,{id:a.descriptionId,...i,ref:t})});H.displayName=z;var V="DialogClose",Q=s.forwardRef((e,t)=>{let{__scopeDialog:r,...i}=e,a=C(V,r);return(0,n.jsx)(x.Primitive.button,{type:"button",...i,ref:t,onClick:(0,o.composeEventHandlers)(e.onClick,()=>a.onOpenChange(!1))})});function K(e){return e?"open":"closed"}Q.displayName=V;var Z="DialogTitleWarning",[Y,J]=(0,d.createContext)(Z,{contentName:k,titleName:W,docsSlug:"dialog"}),X=({titleId:e})=>{let t=J(Z),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return s.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},ee=({contentRef:e,descriptionId:t})=>{let r=J("DialogDescriptionWarning"),i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${r.contentName}}.`;return s.useEffect(()=>{let r=e.current?.getAttribute("aria-describedby");t&&r&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null};let et=(0,e.i(65756).default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["default",()=>et],32977);var er=e.i(67830);function ei(e){let t,r,i=(0,a.c)(4);return i[0]!==e?({...t}=e,i[0]=e,i[1]=t):t=i[1],i[2]!==t?(r=(0,n.jsx)(D,{"data-slot":"dialog",...t}),i[2]=t,i[3]=r):r=i[3],r}function en(e){let t,r,i=(0,a.c)(4);return i[0]!==e?({...t}=e,i[0]=e,i[1]=t):t=i[1],i[2]!==t?(r=(0,n.jsx)(S,{"data-slot":"dialog-trigger",...t}),i[2]=t,i[3]=r):r=i[3],r}function ea(e){let t,r,i=(0,a.c)(4);return i[0]!==e?({...t}=e,i[0]=e,i[1]=t):t=i[1],i[2]!==t?(r=(0,n.jsx)(P,{"data-slot":"dialog-portal",...t}),i[2]=t,i[3]=r):r=i[3],r}function es(e){let t,r,i,s,o=(0,a.c)(8);return o[0]!==e?({className:t,...r}=e,o[0]=e,o[1]=t,o[2]=r):(t=o[1],r=o[2]),o[3]!==t?(i=(0,er.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),o[3]=t,o[4]=i):i=o[4],o[5]!==r||o[6]!==i?(s=(0,n.jsx)(_,{"data-slot":"dialog-overlay",className:i,...r}),o[5]=r,o[6]=i,o[7]=s):s=o[7],s}function eo(e){let t,r,i,s,o,l,d,c,u=(0,a.c)(15);u[0]!==e?({className:r,children:t,showCloseButton:s,...i}=e,u[0]=e,u[1]=t,u[2]=r,u[3]=i,u[4]=s):(t=u[1],r=u[2],i=u[3],s=u[4]);let g=void 0===s||s;return u[5]===Symbol.for("react.memo_cache_sentinel")?(o=(0,n.jsx)(es,{}),u[5]=o):o=u[5],u[6]!==r?(l=(0,er.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",r),u[6]=r,u[7]=l):l=u[7],u[8]!==g?(d=g&&(0,n.jsxs)(Q,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,n.jsx)(et,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}),u[8]=g,u[9]=d):d=u[9],u[10]!==t||u[11]!==i||u[12]!==l||u[13]!==d?(c=(0,n.jsxs)(ea,{"data-slot":"dialog-portal",children:[o,(0,n.jsxs)($,{"data-slot":"dialog-content",className:l,...i,children:[t,d]})]}),u[10]=t,u[11]=i,u[12]=l,u[13]=d,u[14]=c):c=u[14],c}function el(e){let t,r,i,s,o=(0,a.c)(8);return o[0]!==e?({className:t,...r}=e,o[0]=e,o[1]=t,o[2]=r):(t=o[1],r=o[2]),o[3]!==t?(i=(0,er.cn)("flex flex-col gap-2 text-center sm:text-left",t),o[3]=t,o[4]=i):i=o[4],o[5]!==r||o[6]!==i?(s=(0,n.jsx)("div",{"data-slot":"dialog-header",className:i,...r}),o[5]=r,o[6]=i,o[7]=s):s=o[7],s}function ed(e){let t,r,i,s,o=(0,a.c)(8);return o[0]!==e?({className:t,...r}=e,o[0]=e,o[1]=t,o[2]=r):(t=o[1],r=o[2]),o[3]!==t?(i=(0,er.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),o[3]=t,o[4]=i):i=o[4],o[5]!==r||o[6]!==i?(s=(0,n.jsx)("div",{"data-slot":"dialog-footer",className:i,...r}),o[5]=r,o[6]=i,o[7]=s):s=o[7],s}function ec(e){let t,r,i,s,o=(0,a.c)(8);return o[0]!==e?({className:t,...r}=e,o[0]=e,o[1]=t,o[2]=r):(t=o[1],r=o[2]),o[3]!==t?(i=(0,er.cn)("text-lg leading-none font-semibold",t),o[3]=t,o[4]=i):i=o[4],o[5]!==r||o[6]!==i?(s=(0,n.jsx)(q,{"data-slot":"dialog-title",className:i,...r}),o[5]=r,o[6]=i,o[7]=s):s=o[7],s}function eu(e){let t,r,i,s,o=(0,a.c)(8);return o[0]!==e?({className:t,...r}=e,o[0]=e,o[1]=t,o[2]=r):(t=o[1],r=o[2]),o[3]!==t?(i=(0,er.cn)("text-muted-foreground text-sm",t),o[3]=t,o[4]=i):i=o[4],o[5]!==r||o[6]!==i?(s=(0,n.jsx)(H,{"data-slot":"dialog-description",className:i,...r}),o[5]=r,o[6]=i,o[7]=s):s=o[7],s}e.s(["Dialog",()=>ei,"DialogContent",()=>eo,"DialogDescription",()=>eu,"DialogFooter",()=>ed,"DialogHeader",()=>el,"DialogTitle",()=>ec,"DialogTrigger",()=>en],34219)},40633,e=>{"use strict";var t=e.i(73444),r=e.i(75784),i=e.i(67830);function n(e){let n,a,s,o,l=(0,r.c)(8);return l[0]!==e?({className:n,...a}=e,l[0]=e,l[1]=n,l[2]=a):(n=l[1],a=l[2]),l[3]!==n?(s=(0,i.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),l[3]=n,l[4]=s):s=l[4],l[5]!==a||l[6]!==s?(o=(0,t.jsx)("textarea",{"data-slot":"textarea",className:s,...a}),l[5]=a,l[6]=s,l[7]=o):o=l[7],o}e.s(["Textarea",()=>n])},94328,e=>{"use strict";var t=e.i(73444),r=e.i(74907),i=e.i(7272),n=e.i(63835),a=e.i(67608),s=e.i(40633),o=e.i(12286),l=e.i(34219);function d(){let{db:d,setDb:c,currentDbName:u,setCurrentDbName:g}=(0,i.useDatabaseStore)(),[m,f]=(0,r.useState)([]),[p,x]=(0,r.useState)([]),[h,v]=(0,r.useState)(!0),[b,j]=(0,r.useState)(!1),[T,E]=(0,r.useState)(""),[N,y]=(0,r.useState)(!1),[w,C]=(0,r.useState)(""),[D,R]=(0,r.useState)("AFTER"),[S,O]=(0,r.useState)("INSERT"),[I,F]=(0,r.useState)(""),[P,A]=(0,r.useState)(""),[_,L]=(0,r.useState)(!1),[B,k]=(0,r.useState)(null),[$,M]=(0,r.useState)(!1),[U,G]=(0,r.useState)(null),[W,q]=(0,r.useState)(""),[z,H]=(0,r.useState)("AFTER"),[V,Q]=(0,r.useState)("INSERT"),[K,Z]=(0,r.useState)(""),[Y,J]=(0,r.useState)("");(0,r.useEffect)(()=>{!async function(){try{if(d){console.log("[TriggersPage] Using existing database from Zustand:",u),window.testDb=d,v(!1);return}let t=(await e.A(61419)).default,{Database:r}=await e.A(61419);await t(),window.Database=r;let i=u||"database.db";console.log("[TriggersPage] Opening/creating database:",i);let n=await r.newDatabase(i);c(n),window.testDb=n,u||g(i),v(!1)}catch(e){console.error("[TriggersPage] Failed to initialize WASM:",e),E(`Failed to initialize database: ${e}`),v(!1)}}()},[d,c,u,g]);let X=async()=>{if(!d)return void console.error("[TriggersPage] loadTriggers called but db is null");console.log("[TriggersPage] loadTriggers called");try{j(!0),E("");let e=await d.execute("SELECT name, tbl_name, sql FROM sqlite_master WHERE type='trigger' ORDER BY name");console.log("[TriggersPage] Loaded triggers:",e.rows.length),f(e.rows.map(e=>({name:e.values[0].value,tbl_name:e.values[1].value,sql:e.values[2].value})))}catch(e){console.error("[TriggersPage] Error loading triggers:",e),E(`Failed to load triggers: ${e}`)}finally{j(!1)}},ee=async()=>{if(d)try{let e=(await d.execute("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%' ORDER BY name")).rows.map(e=>e.values[0].value);x(e)}catch(e){console.error("[TriggersPage] Error loading tables:",e)}};(0,r.useEffect)(()=>{d&&!h&&(X(),ee(),window.loadTriggers=X,window.loadTables=ee)},[d,h]);let et=e=>{try{let t=e.match(/CREATE\s+TRIGGER\s+(\w+)/i),r=e.match(/\s+(BEFORE|AFTER)\s+/i),i=e.match(/\s+(INSERT|UPDATE|DELETE)\s+/i),n=e.match(/\s+ON\s+(\w+)/i),a=e.match(/BEGIN\s+([\s\S]+)\s+END/i);if(!t||!r||!i||!n||!a)return null;return{name:t[1],timing:r[1].toUpperCase(),event:i[1].toUpperCase(),table:n[1],body:a[1].trim()}}catch(e){return console.error("[TriggersPage] Error parsing trigger SQL:",e),null}},er=async()=>{if(d){if(E(""),!w.trim())return void E("Trigger name is required");if(!I.trim())return void E("Table must be selected");if(!P.trim())return void E("Trigger body is required");if(m.find(e=>e.name.toLowerCase()===w.toLowerCase()))return void E(`Trigger "${w}" already exists`);try{j(!0);let e=`CREATE TRIGGER ${w}
${D} ${S} ON ${I}
BEGIN
  ${P}
END`;console.log("[TriggersPage] Creating trigger with SQL:",e),await d.execute(e),await d.sync(),console.log("[TriggersPage] Trigger created successfully"),y(!1),C(""),R("AFTER"),O("INSERT"),F(""),A(""),await X()}catch(e){console.error("[TriggersPage] Error creating trigger:",e),E(`Failed to create trigger: ${e}`)}finally{j(!1)}}},ei=async()=>{if(d&&B){E("");try{j(!0),console.log("[TriggersPage] Dropping trigger:",B),await d.execute(`DROP TRIGGER ${B}`),await d.sync(),console.log("[TriggersPage] Trigger dropped successfully"),L(!1),k(null),await X()}catch(e){console.error("[TriggersPage] Error dropping trigger:",e),E(`Failed to drop trigger: ${e}`)}finally{j(!1)}}},en=async()=>{if(d&&U){if(E(""),!W.trim())return void E("Trigger name is required");if(!K.trim())return void E("Table must be selected");if(!Y.trim())return void E("Trigger body is required");if(W!==U.name&&m.find(e=>e.name.toLowerCase()===W.toLowerCase()))return void E(`Trigger "${W}" already exists`);try{j(!0),await d.execute("BEGIN TRANSACTION");try{console.log("[TriggersPage] Dropping old trigger:",U.name),await d.execute(`DROP TRIGGER ${U.name}`);let e=`CREATE TRIGGER ${W}
${z} ${V} ON ${K}
BEGIN
  ${Y}
END`;console.log("[TriggersPage] Creating updated trigger with SQL:",e),await d.execute(e),await d.execute("COMMIT"),await d.sync(),console.log("[TriggersPage] Trigger edited successfully"),M(!1),G(null),q(""),H("AFTER"),Q("INSERT"),Z(""),J(""),await X()}catch(e){throw console.error("[TriggersPage] Error during trigger edit, rolling back:",e),await d.execute("ROLLBACK"),e}}catch(e){console.error("[TriggersPage] Error editing trigger:",e),E(`Failed to edit trigger: ${e}`)}finally{j(!1)}}};return h?(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)("p",{children:"Initializing database..."})}):(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Triggers Management"}),(0,t.jsxs)("p",{className:"text-muted-foreground mt-1",children:[m.length," ",1===m.length?"trigger":"triggers"]})]}),(0,t.jsx)(n.Button,{onClick:()=>y(!0),children:"Create Trigger"})]}),T&&(0,t.jsx)("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded","data-testid":"error-message",children:T}),b&&(0,t.jsx)("div",{className:"text-muted-foreground",children:"Loading..."}),0!==m.length||b?(0,t.jsx)("div",{className:"grid gap-4",children:m.map(e=>{let r=et(e.sql);return(0,t.jsxs)(o.Card,{"data-trigger-card":e.name,children:[(0,t.jsx)(o.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(o.CardTitle,{"data-slot":"card-title",children:e.name}),(0,t.jsx)(o.CardDescription,{className:"mt-1",children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"font-medium",children:r.timing})," ",(0,t.jsx)("span",{className:"font-medium",children:r.event})," on ",(0,t.jsx)("span",{className:"font-medium",children:r.table})]}):`On ${e.tbl_name}`})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.Button,{variant:"outline",size:"sm",onClick:()=>{let t;!(t=et(e.sql))?E("Failed to parse trigger SQL for editing"):(G(t),q(t.name),H(t.timing),Q(t.event),Z(t.table),J(t.body),M(!0))},children:"Edit"}),(0,t.jsx)(n.Button,{variant:"destructive",size:"sm",onClick:()=>{k(e.name),L(!0)},children:"Drop"})]})]})}),(0,t.jsx)(o.CardContent,{children:(0,t.jsx)("div",{className:"bg-muted p-3 rounded text-sm font-mono overflow-x-auto","data-trigger-sql":!0,children:e.sql})})]},e.name)})}):(0,t.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"No triggers found. Create one to get started."}),(0,t.jsx)(l.Dialog,{open:N,onOpenChange:y,children:(0,t.jsxs)(l.DialogContent,{className:"max-w-2xl",children:[(0,t.jsxs)(l.DialogHeader,{children:[(0,t.jsx)(l.DialogTitle,{children:"Create Trigger"}),(0,t.jsx)(l.DialogDescription,{children:"Create a new database trigger"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[T&&(0,t.jsx)("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded text-sm","data-testid":"dialog-error-message",children:T}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"triggerName",className:"text-sm font-medium",children:"Trigger Name"}),(0,t.jsx)(a.Input,{id:"triggerName",value:w,onChange:e=>C(e.target.value),placeholder:"my_trigger"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"triggerTiming",className:"text-sm font-medium",children:"Timing"}),(0,t.jsxs)("select",{id:"triggerTiming",value:D,onChange:e=>R(e.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",children:[(0,t.jsx)("option",{value:"BEFORE",children:"BEFORE"}),(0,t.jsx)("option",{value:"AFTER",children:"AFTER"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"triggerEvent",className:"text-sm font-medium",children:"Event"}),(0,t.jsxs)("select",{id:"triggerEvent",value:S,onChange:e=>O(e.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",children:[(0,t.jsx)("option",{value:"INSERT",children:"INSERT"}),(0,t.jsx)("option",{value:"UPDATE",children:"UPDATE"}),(0,t.jsx)("option",{value:"DELETE",children:"DELETE"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"triggerTable",className:"text-sm font-medium",children:"Table"}),(0,t.jsxs)("select",{id:"triggerTable",value:I,onChange:e=>F(e.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",children:[(0,t.jsx)("option",{value:"",children:"Select a table..."}),p.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"triggerBody",className:"text-sm font-medium",children:"Trigger Body (SQL between BEGIN and END)"}),(0,t.jsx)(s.Textarea,{id:"triggerBody",value:P,onChange:e=>A(e.target.value),placeholder:"INSERT INTO audit_log (action) VALUES ('something');",rows:8,className:"font-mono text-sm"})]})]}),(0,t.jsxs)(l.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{id:"confirmCreateTrigger",onClick:er,disabled:b,children:b?"Creating...":"Create Trigger"})]})]})}),(0,t.jsx)(l.Dialog,{open:$,onOpenChange:M,children:(0,t.jsxs)(l.DialogContent,{className:"max-w-2xl",children:[(0,t.jsxs)(l.DialogHeader,{children:[(0,t.jsx)(l.DialogTitle,{children:"Edit Trigger"}),(0,t.jsx)(l.DialogDescription,{children:"Edit the trigger (will drop and recreate)"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[T&&(0,t.jsx)("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded text-sm","data-testid":"dialog-error-message",children:T}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editTriggerName",className:"text-sm font-medium",children:"Trigger Name"}),(0,t.jsx)(a.Input,{id:"editTriggerName",value:W,onChange:e=>q(e.target.value),placeholder:"my_trigger"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editTriggerTiming",className:"text-sm font-medium",children:"Timing"}),(0,t.jsxs)("select",{id:"editTriggerTiming",value:z,onChange:e=>H(e.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",children:[(0,t.jsx)("option",{value:"BEFORE",children:"BEFORE"}),(0,t.jsx)("option",{value:"AFTER",children:"AFTER"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editTriggerEvent",className:"text-sm font-medium",children:"Event"}),(0,t.jsxs)("select",{id:"editTriggerEvent",value:V,onChange:e=>Q(e.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",children:[(0,t.jsx)("option",{value:"INSERT",children:"INSERT"}),(0,t.jsx)("option",{value:"UPDATE",children:"UPDATE"}),(0,t.jsx)("option",{value:"DELETE",children:"DELETE"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editTriggerTable",className:"text-sm font-medium",children:"Table"}),(0,t.jsxs)("select",{id:"editTriggerTable",value:K,onChange:e=>Z(e.target.value),className:"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring",children:[(0,t.jsx)("option",{value:"",children:"Select a table..."}),p.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editTriggerBody",className:"text-sm font-medium",children:"Trigger Body (SQL between BEGIN and END)"}),(0,t.jsx)(s.Textarea,{id:"editTriggerBody",value:Y,onChange:e=>J(e.target.value),placeholder:"INSERT INTO audit_log (action) VALUES ('something');",rows:8,className:"font-mono text-sm"})]})]}),(0,t.jsxs)(l.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{id:"confirmEditTrigger",onClick:en,disabled:b,children:b?"Saving...":"Save Changes"})]})]})}),(0,t.jsx)(l.Dialog,{open:_,onOpenChange:L,children:(0,t.jsxs)(l.DialogContent,{children:[(0,t.jsxs)(l.DialogHeader,{children:[(0,t.jsx)(l.DialogTitle,{children:"Drop Trigger"}),(0,t.jsxs)(l.DialogDescription,{children:['Are you sure you want to drop the trigger "',B,'"? This action cannot be undone.']})]}),(0,t.jsxs)(l.DialogFooter,{children:[(0,t.jsx)(n.Button,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),(0,t.jsx)(n.Button,{variant:"destructive",onClick:ei,disabled:b,children:b?"Dropping...":"Drop Trigger"})]})]})})]})}e.s(["default",()=>d])},61419,e=>{e.v(t=>Promise.all(["static/chunks/0d126131a3369877.js"].map(t=>e.l(t))).then(()=>t(4948)))}]);