module.exports=[22367,(a,b,c)=>{"use strict";b.exports=a.r(76686).vendored["react-ssr"].ReactJsxRuntime},14400,a=>{a.v("/_next/static/media/absurder_sql_bg.4b006aa8.wasm")},17766,a=>{"use strict";var b=a.i(69732);class c{db=null;dbName=null;initialized=!1;async initialize(){if(!this.initialized)try{await (0,b.default)(),this.initialized=!0}catch(a){throw console.error("Failed to initialize WASM module:",a),Error(`WASM initialization failed: ${a}`)}}isInitialized(){return this.initialized}async open(a){if(await this.initialize(),this.db)throw Error("Database is already open. Close it first.");try{this.db=await b.Database.newDatabase(a),this.dbName=a,console.log(`DatabaseClient: Opened database "${a}"`)}catch(a){throw console.error("DatabaseClient: Failed to open database:",a),Error(`Failed to open database: ${a}`)}}async execute(a,b){if(!this.db)throw Error("Database not opened. Call open() first.");try{if(b&&b.length>0)return await this.db.executeWithParams(a,b);return await this.db.execute(a)}catch(a){throw console.error("Query execution failed:",a),Error(`Query failed: ${a}`)}}async export(){if(!this.db)throw Error("Database not opened. Call open() first.");try{let a=await this.db.exportToFile();return new Blob([a],{type:"application/x-sqlite3"})}catch(a){throw console.error("Database export failed:",a),Error(`Export failed: ${a}`)}}async import(a){if(!this.db||!this.dbName)throw Error("Database not opened. Call open() first to create initial database instance.");try{let c=await a.arrayBuffer();await this.db.importFromFile(new Uint8Array(c)),console.log(`Import complete, reopening database "${this.dbName}"...`),this.db=await b.Database.newDatabase(this.dbName),console.log("Database reopened after import")}catch(a){throw console.error("Database import failed:",a),Error(`Import failed: ${a}`)}}async sync(){if(!this.db)throw Error("Database not opened. Call open() first.");try{await this.db.sync()}catch(a){throw console.error("Database sync failed:",a),Error(`Sync failed: ${a}`)}}async close(){if(this.db)try{await this.db.close(),this.db=null,this.dbName=null}catch(a){throw console.error("Database close failed:",a),Error(`Close failed: ${a}`)}}isOpen(){return null!==this.db}getDatabaseName(){return this.dbName}async exportDatabase(){return this.export()}async importDatabase(a,c){await this.initialize(),this.db&&await this.close();try{this.db=await b.Database.newDatabase(a),this.dbName=a;let d=await c.arrayBuffer();await this.db.importFromFile(new Uint8Array(d)),console.log(`Import complete, reopening database "${a}"...`),this.db=await b.Database.newDatabase(a),console.log("Database reopened after import")}catch(a){throw console.error("Database import failed:",a),this.db=null,this.dbName=null,Error(`Import failed: ${a}`)}}async deleteDatabase(a){await this.initialize(),this.dbName===a&&this.db&&await this.close();try{let b=indexedDB.deleteDatabase(a);await new Promise((c,d)=>{b.onsuccess=()=>{console.log(`Deleted database "${a}"`),c()},b.onerror=()=>{d(Error(`Failed to delete database: ${b.error}`))},b.onblocked=()=>{console.warn(`Delete blocked for database "${a}". Close all connections first.`)}})}catch(b){throw console.error(`Failed to delete database "${a}":`,b),Error(`Delete failed: ${b}`)}}getDatabase(){return this.db}async isLeader(){if(!this.db)throw Error("Database not opened. Call open() first.");return await this.db.isLeader()}async waitForLeadership(){if(!this.db)throw Error("Database not opened. Call open() first.");return await this.db.waitForLeadership()}async requestLeadership(){if(!this.db)throw Error("Database not opened. Call open() first.");return await this.db.requestLeadership()}async allowNonLeaderWrites(a){if(!this.db)throw Error("Database not opened. Call open() first.");return await this.db.allowNonLeaderWrites(a)}}a.s(["DatabaseClient",()=>c])},69782,a=>{"use strict";var b=a.i(22367),c=a.i(97863),d=a.i(17766);let e=(0,c.createContext)(void 0);function f({children:a,dbName:f}){let[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(null),m=async a=>{j(!0),l(null);try{let b=new d.DatabaseClient;await b.open(a),h(b),console.log(`DatabaseProvider: Initialized database "${a}"`)}catch(a){console.error("DatabaseProvider: Initialization failed:",a),l(a)}finally{j(!1)}};(0,c.useEffect)(()=>(m(f),()=>{g&&g.close().catch(a=>{console.error("DatabaseProvider: Failed to close database on unmount:",a)})}),[f]);let n=async a=>{g&&await g.close(),await m(a)};return(0,b.jsx)(e.Provider,{value:{db:g,loading:i,error:k,reinitialize:n},children:a})}function g(){let a=(0,c.useContext)(e);if(void 0===a)throw Error("useDatabase must be used within a DatabaseProvider");return a}a.s(["DatabaseProvider",()=>f,"useDatabase",()=>g])},31034,a=>{"use strict";var b=a.i(22367),c=a.i(97863),d=a.i(69782);function e(){let{db:a}=(0,d.useDatabase)(),[e,f]=(0,c.useState)(""),g=async()=>{if(a)try{await a.execute("DROP TABLE IF EXISTS shared_data"),await a.execute("CREATE TABLE shared_data (id INTEGER, value TEXT)"),await a.execute("INSERT INTO shared_data VALUES (?, ?)",[{type:"Integer",value:1},{type:"Text",value:"shared data"}]),f("Write complete")}catch(a){console.error("Component1 write error:",a)}};return(0,b.jsxs)("div",{children:[(0,b.jsx)("button",{id:"component1Write",onClick:g,disabled:!a,children:"Component 1 Write"}),(0,b.jsx)("p",{id:"component1Result",children:e})]})}function f(){let{db:a}=(0,d.useDatabase)(),[e,f]=(0,c.useState)(""),g=async()=>{if(a)try{let b=await a.execute("SELECT * FROM shared_data WHERE id = 1");if(b.rows.length>0){let a=b.rows[0].values[1],c="Text"===a.type?a.value:null;window.component2Data=c,f("Read complete")}}catch(a){console.error("Component2 read error:",a)}};return(0,b.jsxs)("div",{children:[(0,b.jsx)("button",{id:"component2Read",onClick:g,disabled:!a,children:"Component 2 Read"}),(0,b.jsx)("p",{id:"component2Result",children:e})]})}function g(){let{db:a,error:e}=(0,d.useDatabase)(),[f,g]=(0,c.useState)(null);(0,c.useEffect)(()=>{e&&(window.contextError=e)},[e]);let h=async()=>{if(a)try{await a.execute("INVALID SQL SYNTAX")}catch(a){g(a),window.contextError=a}};return(0,b.jsxs)("div",{children:[(0,b.jsx)("button",{id:"triggerError",onClick:h,disabled:!a,children:"Trigger Error"}),(0,b.jsx)("p",{id:"errorDisplay",children:f||e?"Database error":""})]})}function h(){let{db:a,loading:h,error:i}=(0,d.useDatabase)();return(0,c.useEffect)(()=>{},[a,h]),(0,b.jsxs)("div",{style:{padding:"20px",fontFamily:"system-ui"},children:[(0,b.jsx)("h1",{children:"Provider Test Page"}),(0,b.jsx)("p",{id:"status",children:h?"Loading...":i?`Error: ${i.message}`:"Provider ready"}),(0,b.jsx)("div",{style:{marginTop:"20px"},children:(0,b.jsx)(e,{})}),(0,b.jsx)("div",{style:{marginTop:"20px"},children:(0,b.jsx)(f,{})}),(0,b.jsx)("div",{style:{marginTop:"20px"},children:(0,b.jsx)(g,{})})]})}function i(){return(0,b.jsx)(d.DatabaseProvider,{dbName:"provider_test.db",children:(0,b.jsx)(h,{})})}a.s(["default",()=>i])}];

//# sourceMappingURL=pwa_aec3f78e._.js.map