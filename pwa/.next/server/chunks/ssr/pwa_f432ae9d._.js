module.exports=[22367,(a,b,c)=>{"use strict";b.exports=a.r(76686).vendored["react-ssr"].ReactJsxRuntime},31442,(a,b,c)=>{"use strict";b.exports=a.r(76686).vendored["react-ssr"].ReactDOM},88184,a=>{"use strict";var b=a.i(22367),c=a.i(97863),d=a.i(57372),e=a.i(5193),f=a.i(45061),g=a.i(88762),h=a.i(23105);function i(){let{db:a,currentDbName:i,loading:j,status:k,tableCount:l,showSystemTables:m,_hasHydrated:n,setDb:o,setCurrentDbName:p,setLoading:q,setStatus:r,setTableCount:s,setShowSystemTables:t}=(0,h.useDatabaseStore)(),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),I=(0,c.useRef)(null);(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{let b=window.Database;async function c(){try{if(i){console.log(`[PWA] Restoring database from localStorage: ${i}`);let a=await b.newDatabase(i);console.log("[PWA] Database.newDatabase() returned successfully"),o(a),window.testDb=a,console.log(`[PWA] Database restored successfully: ${i}`),r(`Loaded: ${i}`)}else console.log("[PWA] No currentDbName in localStorage"),r("Create or import a database to get started")}catch(a){console.error("[PWA] Failed to load database:",a),r(`Error loading database: ${a.message}`)}}console.log("[PWA] loadDatabase useEffect triggered",{wasmReady:E,hasHydrated:n,hasDb:!!a,currentDbName:i}),E&&n&&!a&&c()},[E,n,i]);let J=async()=>{let b=window.Database;if(u.trim()&&b)try{a&&await a.close();let c=u.endsWith(".db")?u:`${u}.db`,d=await b.newDatabase(c);o(d),p(c),window.testDb=d,r(`Database created: ${c}`),x(!1),v("")}catch(a){r(`Error: ${a.message}`)}},K=async()=>{if(a)try{let b=await a.exportToFile(),c=new Blob([b],{type:"application/x-sqlite3"}),d=URL.createObjectURL(c),e=document.createElement("a");e.href=d;let f=i||"database.db";e.download=f.endsWith(".db")?f:`${f}.db`,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(d),r("Database exported")}catch(a){r(`Export error: ${a.message}`)}},L=async()=>{let b=window.Database;if(!b)return;let c=I.current?.files?.[0];if(!c)return void r("No file selected");try{let d=await c.arrayBuffer(),e=new Uint8Array(d);a&&await a.close();let f=c.name,g=await b.newDatabase(f);await g.importFromFile(e),await g.close();let h=await b.newDatabase(f);o(h),p(f),window.testDb=h,r(`Import complete: ${f}`),D(null),I.current&&(I.current.value="")}catch(a){r(`Import error: ${a.message}`)}},M=async()=>{if(a)try{let b=m?"SELECT type, name FROM sqlite_master ORDER BY name":"SELECT type, name FROM sqlite_master WHERE name NOT LIKE 'sqlite_%' ORDER BY name",c=await a.execute(b);s(c.rows.length);let d=await a.execute("SELECT sqlite_version()"),e=d.rows[0]?.values[0]?.value||"unknown";if(c.rows.length>0){let a=c.rows.map(a=>{let b=a.values[0].value,c=a.values[1].value;return`${c} (${b})`}).join("\n");H(`SQLite ${e}

Objects found:
${a}`),r("Info refreshed")}else H(`SQLite ${e}

Query: ${b}

Result: 0 rows (empty database)`),r("Info refreshed")}catch(a){r(`Error: ${a}`),H(`Error executing query: ${a}`)}};(0,c.useEffect)(()=>{a&&M()},[m]);let N=async()=>{let b=window.Database;if(a&&b)try{await a.close(),await b.deleteDatabase(i),o(null),p(""),window.testDb=null,r("Database deleted - create or import a new database"),z(!1)}catch(a){r(`Delete error: ${a.message}`)}},O=async b=>{b.preventDefault(),b.stopPropagation(),B(!1);let c=Array.from(b.dataTransfer.files);if(0===c.length)return;let d=c[0];if(!d.name.endsWith(".db")&&!d.name.endsWith(".sqlite")&&!d.name.endsWith(".sqlite3"))return void r("Error: Please drop a valid .db file");let e=window.Database;if(!a||!e)return void r("Error: Database not initialized");try{let b=await d.arrayBuffer(),c=new Uint8Array(b);await a.close();let f=await e.newDatabase(i);await f.importFromFile(c),await f.close();let g=await e.newDatabase(i);o(g),window.testDb=g,r("Import complete"),D(null)}catch(a){r(`Import error: ${a.message}`)}};return(0,b.jsxs)("div",{id:"dbManagement",className:"container mx-auto p-6 max-w-4xl",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Database Management"}),(0,b.jsx)("div",{id:"status",className:"mb-4 p-3 bg-blue-50 rounded",children:k}),(0,b.jsx)("div",{id:"dropZone",onDragOver:a=>{a.preventDefault(),a.stopPropagation(),B(!0)},onDragLeave:a=>{a.preventDefault(),a.stopPropagation(),B(!1)},onDrop:O,className:`mb-6 p-8 border-2 border-dashed rounded-lg text-center transition-colors ${A?"border-blue-500 bg-blue-50 drag-over":"border-gray-300 bg-gray-50"}`,children:(0,b.jsx)("p",{className:"text-gray-600",children:A?"Drop your .db file here":"Drag and drop a .db file here to import"})}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Database Operations"}),(0,b.jsx)(f.CardDescription,{children:"Manage your database"})]}),(0,b.jsxs)(f.CardContent,{className:"space-y-2",children:[(0,b.jsxs)("div",{id:"dbSelector",className:"text-sm text-muted-foreground mb-4",children:["Current database: ",i||"None (create or import a database)"]}),(0,b.jsx)("input",{ref:I,id:"importFile",type:"file",accept:".db,.sqlite,.sqlite3",className:"hidden",onChange:a=>D(a.target.files?.[0]||null)}),(0,b.jsxs)(g.Dialog,{open:w,onOpenChange:x,children:[(0,b.jsx)(g.DialogTrigger,{asChild:!0,children:(0,b.jsx)(d.Button,{id:"createDbButton",className:"w-full",children:"Create New Database"})}),(0,b.jsxs)(g.DialogContent,{children:[(0,b.jsxs)(g.DialogHeader,{children:[(0,b.jsx)(g.DialogTitle,{children:"Create New Database"}),(0,b.jsx)(g.DialogDescription,{children:"Enter a name for your new database"})]}),(0,b.jsx)(e.Input,{id:"dbNameInput",placeholder:"my_database",value:u,onChange:a=>v(a.target.value)}),(0,b.jsx)(g.DialogFooter,{children:(0,b.jsx)(d.Button,{id:"confirmCreate",onClick:J,children:"Create"})})]})]}),(0,b.jsx)(d.Button,{id:"exportDbButton",onClick:K,disabled:!a,className:"w-full",variant:"outline",children:"Export Database"}),(0,b.jsx)(d.Button,{id:"importDbButton",onClick:()=>I.current?.click(),className:"w-full",variant:"outline",children:"Select File to Import"}),(0,b.jsx)(d.Button,{onClick:L,disabled:!C,className:"w-full",variant:"outline",children:"Import Selected File"}),(0,b.jsxs)(g.Dialog,{open:y,onOpenChange:z,children:[(0,b.jsx)(g.DialogTrigger,{asChild:!0,children:(0,b.jsx)(d.Button,{id:"deleteDbButton",disabled:!a,className:"w-full",variant:"destructive",children:"Delete Database"})}),(0,b.jsxs)(g.DialogContent,{children:[(0,b.jsxs)(g.DialogHeader,{children:[(0,b.jsx)(g.DialogTitle,{children:"Confirm Delete"}),(0,b.jsx)(g.DialogDescription,{children:"Are you sure you want to delete this database?"})]}),(0,b.jsx)(g.DialogFooter,{children:(0,b.jsx)(d.Button,{id:"confirmDelete",onClick:N,variant:"destructive",children:"Delete"})})]})]})]})]}),(0,b.jsxs)(f.Card,{children:[(0,b.jsxs)(f.CardHeader,{children:[(0,b.jsx)(f.CardTitle,{children:"Database Info"}),(0,b.jsx)(f.CardDescription,{children:"Current database statistics"})]}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-semibold",children:"Tables: "}),(0,b.jsx)("span",{id:"tableCount",children:l})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"showSystemTables",checked:m,onChange:a=>t(a.target.checked),className:"cursor-pointer"}),(0,b.jsx)("label",{htmlFor:"showSystemTables",className:"text-sm cursor-pointer",children:"Show system tables (sqlite_*)"})]}),(0,b.jsx)(d.Button,{id:"refreshInfo",onClick:M,disabled:!a,size:"sm",children:"Refresh Info"}),G&&(0,b.jsx)("pre",{className:"mt-4 p-3 bg-gray-100 dark:bg-gray-800 rounded text-sm whitespace-pre-wrap font-mono",children:G})]})})]})]})]})}a.s(["default",()=>i])},85002,a=>{a.v(b=>Promise.all(["server/chunks/ssr/7dc3a_@npiesco_absurder-sql_absurder_sql_bg_wasm_8664c6f1._.js","server/chunks/ssr/7dc3a_@npiesco_absurder-sql_absurder_sql_1f32a207.js"].map(b=>a.l(b))).then(()=>b(69732)))}];

//# sourceMappingURL=pwa_f432ae9d._.js.map