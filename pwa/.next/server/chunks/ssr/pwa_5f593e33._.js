module.exports=[22367,(a,b,c)=>{"use strict";b.exports=a.r(76686).vendored["react-ssr"].ReactJsxRuntime},97654,a=>{"use strict";var b=a.i(97863);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],97654)},98138,a=>{"use strict";var b=a.i(22367),c=a.i(78109),d=a.i(12102);let e=(0,c.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{className:(0,d.cn)(e({variant:c}),a),...f})}a.s(["Badge",()=>f])},40089,a=>{"use strict";var b=a.i(22367),c=a.i(97863),d=a.i(23105),e=a.i(45061),f=a.i(57372),g=a.i(97654);let h=(0,g.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),i=(0,g.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),j=(0,g.default)("table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]),k=(0,g.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),l=(0,g.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);var m=a.i(98138);function n(){let{db:a}=(0,d.useDatabaseStore)(),[g,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(0),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)(null);(0,c.useEffect)(()=>{},[a]);let w=a=>0===a?"0 bytes":a<1024?`${a} bytes`:a<1048576?`${(a/1024).toFixed(2)} KB`:a<0x40000000?`${(a/1048576).toFixed(2)} MB`:`${(a/0x40000000).toFixed(2)} GB`,x=async()=>{try{if(!a)return 4096;let b=await a.execute("PRAGMA page_size");if(b.rows&&b.rows.length>0)return b.rows[0].values[0].value;return 4096}catch(a){return 4096}},y=async b=>{try{if(!a)return 0;await x();let c=await a.execute(`SELECT SUM(pgsize) as size FROM dbstat WHERE name='${b}'`);if(c.rows&&c.rows.length>0){let a=c.rows[0].values[0];if(a.value)return a.value}let d=await a.execute(`SELECT COUNT(*) as count FROM ${b}`);if(d.rows&&d.rows.length>0){let a=d.rows[0].values[0].value;return 100*a}return 0}catch(c){try{let c=await a.execute(`SELECT COUNT(*) as count FROM ${b}`);if(c.rows&&c.rows.length>0){let a=c.rows[0].values[0].value;return 100*a}}catch(a){}return 0}},z=async b=>{try{if(!a)return 0;let c=await a.execute(`SELECT SUM(pgsize) as size FROM dbstat WHERE name='${b}'`);if(c.rows&&c.rows.length>0){let a=c.rows[0].values[0];if(a.value)return a.value}return 1024}catch(a){return 1024}},A=(0,c.useCallback)(async()=>{if(!a)return void v("No database connected");n(!0),v(null);try{let b=(await a.execute("SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'")).rows.map(async b=>{let c=b.values[0].value,d=(await a.execute(`SELECT COUNT(*) as count FROM ${c}`)).rows[0].values[0].value,e=await y(c);return{name:c,rowCount:d,size:e}}),c=await Promise.all(b);r(c);let d=(await a.execute("SELECT name, tbl_name FROM sqlite_master WHERE type='index' AND name NOT LIKE 'sqlite_%'")).rows.map(async a=>{let b=a.values[0].value,c=a.values[1].value,d=await z(b);return{name:b,tableName:c,size:d}}),e=await Promise.all(d);t(e);let f=c.reduce((a,b)=>a+b.size,0),g=e.reduce((a,b)=>a+b.size,0),h=f+g;p(h>0?h:8192)}catch(a){v(a instanceof Error?a.message:"Failed to load storage information")}finally{n(!1)}},[a]);return((0,c.useEffect)(()=>{a&&A()},[a]),u)?(0,b.jsx)("div",{className:"container mx-auto p-6",children:(0,b.jsxs)(e.Card,{className:"border-red-200 bg-red-50",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{className:"text-red-700",children:"Error"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("p",{className:"text-red-600",children:u})})]})}):(0,b.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Storage Analysis"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Analyze database storage usage and optimize performance"})]}),(0,b.jsxs)(f.Button,{id:"refreshStorageButton",onClick:()=>{A()},disabled:g,variant:"outline",children:[(0,b.jsx)(h,{className:`mr-2 h-4 w-4 ${g?"animate-spin":""}`}),"Refresh"]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i,{className:"h-5 w-5"}),"Database Size"]}),(0,b.jsx)(e.CardDescription,{children:"Total storage used by the database"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"text-4xl font-bold","data-testid":"db-size",children:w(o)})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j,{className:"h-5 w-5"}),"Tables"]}),(0,b.jsx)(e.CardDescription,{children:"Storage breakdown by table"})]}),(0,b.jsx)(e.CardContent,{children:0===q.length?(0,b.jsx)("p",{className:"text-muted-foreground",children:"No tables found in this database."}):(0,b.jsx)("div",{className:"space-y-4",children:q.map(a=>(0,b.jsxs)("div",{"data-table":a.name,"data-table-name":a.name,className:"flex items-center justify-between p-4 border rounded-lg hover:bg-accent",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.rowCount," ",1===a.rowCount?"row":"rows"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"font-medium table-size","data-testid":"table-size",children:w(a.size)}),(0,b.jsxs)(m.Badge,{variant:"secondary",className:"mt-1",children:[(0,b.jsx)(l,{className:"h-3 w-3 mr-1"}),"Table"]})]})]},a.name))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k,{className:"h-5 w-5"}),"Indexes"]}),(0,b.jsx)(e.CardDescription,{children:"Storage used by indexes"})]}),(0,b.jsx)(e.CardContent,{children:0===s.length?(0,b.jsx)("p",{className:"text-muted-foreground",children:"No indexes found in this database."}):(0,b.jsx)("div",{className:"space-y-4",children:s.map(a=>(0,b.jsxs)("div",{"data-index":a.name,className:"flex items-center justify-between p-4 border rounded-lg hover:bg-accent",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium",children:a.name}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["on table: ",a.tableName]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"font-medium index-size","data-testid":"index-size",children:w(a.size)}),(0,b.jsxs)(m.Badge,{variant:"secondary",className:"mt-1",children:[(0,b.jsx)(k,{className:"h-3 w-3 mr-1"}),"Index"]})]})]},a.name))})})]})]})}function o(){return(0,d.useDatabaseStore)(a=>a.currentDbName)?(0,b.jsx)(n,{}):(0,b.jsx)("div",{className:"container mx-auto p-8",children:(0,b.jsx)("div",{className:"text-center text-gray-600",children:"No database selected. Please create or open a database first."})})}a.s(["default",()=>o],40089)},85002,a=>{a.v(b=>Promise.all(["server/chunks/ssr/7dc3a_@npiesco_absurder-sql_absurder_sql_bg_wasm_8664c6f1._.js","server/chunks/ssr/7dc3a_@npiesco_absurder-sql_absurder_sql_1f32a207.js"].map(b=>a.l(b))).then(()=>b(69732)))}];

//# sourceMappingURL=pwa_5f593e33._.js.map