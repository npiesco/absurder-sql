module.exports=[91285,a=>{"use strict";var b=a.i(22367),c=a.i(97863),d=a.i(23105),e=a.i(57372),f=a.i(5193),g=a.i(2719),h=a.i(82995),i=a.i(45061),j=a.i(88762),k=a.i(41313),l=a.i(37811),m=a.i(98138);function n(){let{db:a}=(0,d.useDatabaseStore)(),{showSystemTables:n}=(0,d.useDatabaseStore)(),[o,p]=(0,c.useState)(null),q=a||o,[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)({name:"",type:"TEXT",notNull:!1,unique:!1,defaultValue:""}),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(""),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(!1),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(null),[ab,ac]=(0,c.useState)(!1),[ad,ae]=(0,c.useState)(""),[af,ag]=(0,c.useState)(!1);(0,c.useEffect)(()=>{},[a]),(0,c.useEffect)(()=>{},[o]);let ah=a=>"Null"===a.type?null:a.value,ai=async()=>{if(q)try{let a=n?"":" AND name NOT LIKE 'sqlite_%'",b=(await q.execute(`SELECT name FROM sqlite_master WHERE type='table'${a} ORDER BY name`)).rows.map(a=>({name:ah(a.values[0])||""}));console.log("[TableDesigner] Found tables:",b.map(a=>a.name)),s(b),b.length>0&&!t&&(console.log("[TableDesigner] Auto-selecting first table:",b[0].name),u(b[0].name))}catch(a){A(`Error loading tables: ${a.message}`),console.error("[TableDesigner] Error loading tables:",a)}},aj=async a=>{if(q&&a)try{let b=(await q.execute(`PRAGMA table_info(${a})`)).rows.map(a=>({cid:ah(a.values[0]),name:ah(a.values[1]),type:ah(a.values[2]),notnull:ah(a.values[3]),dflt_value:ah(a.values[4]),pk:ah(a.values[5])}));w(b);let c=(await q.execute(`PRAGMA index_list(${a})`)).rows.map(a=>({seq:ah(a.values[0]),name:ah(a.values[1]),unique:ah(a.values[2]),origin:ah(a.values[3]),partial:ah(a.values[4])}));y(c),A(`Loaded structure for table: ${a}`)}catch(a){A(`Error loading structure: ${a.message}`)}};(0,c.useEffect)(()=>{q&&ai()},[q,n]),(0,c.useEffect)(()=>{t&&aj(t)},[t]);let ak=async()=>{if(q&&t){if(!F.name.trim())return void C("Column name is required");C(""),A("Adding column...");try{let a=`ALTER TABLE ${t} ADD COLUMN ${F.name} ${F.type}`;if(F.notNull&&(a+=" NOT NULL"),F.defaultValue){let b="TEXT"===F.type?`'${F.defaultValue.replace(/'/g,"''")}'`:F.defaultValue;a+=` DEFAULT ${b}`}if(console.log("[TableDesigner] Executing:",a),await q.execute(a),F.unique){let a=`unique_${t}_${F.name}`,b=`CREATE UNIQUE INDEX ${a} ON ${t}(${F.name})`;console.log("[TableDesigner] Creating unique index:",b),await q.execute(b)}await aj(t),G({name:"",type:"TEXT",notNull:!1,unique:!1,defaultValue:""}),E(!1),A(`Column "${F.name}" added successfully`)}catch(a){C(`Error adding column: ${a.message}`),console.error("[TableDesigner] Error adding column:",a)}}},al=async()=>{if(q&&t&&J){C(""),A(`Deleting column "${J.name}"...`);try{console.log("[TableDesigner] Deleting column:",J.name);let a=await q.execute(`PRAGMA index_list(${t})`);for(let b of(console.log("[TableDesigner] Index list:",a.rows),a.rows)){let a=ah(b.values[1]),c=await q.execute(`PRAGMA index_info(${a})`);for(let b of(console.log("[TableDesigner] Index info for",a,":",c.rows),c.rows))if(ah(b.values[2])===J.name){console.log("[TableDesigner] Dropping index:",a),await q.execute(`DROP INDEX ${a}`);break}}let b=`ALTER TABLE ${t} DROP COLUMN ${J.name}`;console.log("[TableDesigner] Executing:",b),await q.execute(b),await aj(t),I(!1),K(null),A(`Column "${J.name}" deleted successfully`)}catch(a){C(`Error deleting column: ${a.message}`),console.error("[TableDesigner] Error deleting column:",a)}}},am=async()=>{if(q&&t&&N){if(!P.trim())return void C("Column name is required");if(P===N.name){M(!1),O(null),A("No changes made");return}C(""),A(`Renaming column "${N.name}" to "${P}"...`);try{console.log("[TableDesigner] Renaming column:",N.name,"to",P);let a=`ALTER TABLE ${t} RENAME COLUMN ${N.name} TO ${P}`;console.log("[TableDesigner] Executing:",a),await q.execute(a),await aj(t),M(!1),O(null),Q(""),A(`Column renamed to "${P}" successfully`)}catch(a){C(`Error renaming column: ${a.message}`),console.error("[TableDesigner] Error renaming column:",a)}}},an=async()=>{if(console.log("[TableDesigner] handleCreateIndex called",{db:!!a,selectedTable:t,indexName:T,selectedColumns:X}),!q||!t)return void console.log("[TableDesigner] No db or selectedTable, returning");if(!T.trim()){console.log("[TableDesigner] Index name is empty"),C("Index name is required");return}if(0===X.length){console.log("[TableDesigner] No columns selected"),C("Please select at least one column for the index");return}C(""),A(`Creating index "${T}"...`);try{console.log("[TableDesigner] Creating index:",T,"on columns:",X,"unique:",V);let a=V?"UNIQUE ":"",b=X.join(", "),c=`CREATE ${a}INDEX ${T} ON ${t} (${b})`;console.log("[TableDesigner] Executing SQL:",c),await q.execute(c),console.log("[TableDesigner] Index created successfully"),await aj(t),S(!1),U(""),W(!1),Y([]),A(`Index "${T}" created successfully`),console.log("[TableDesigner] Dialog closed, state reset")}catch(a){C(`Error creating index: ${a.message}`),console.error("[TableDesigner] Error creating index:",a)}},ao=async()=>{if(q&&t&&_){C(""),A(`Dropping index "${_}"...`);try{console.log("[TableDesigner] Dropping index:",_);let a=`DROP INDEX ${_}`;console.log("[TableDesigner] Executing SQL:",a),await q.execute(a),console.log("[TableDesigner] Index dropped successfully"),await aj(t),$(!1),aa(null),A(`Index "${_}" dropped successfully`),console.log("[TableDesigner] Dialog closed, state reset")}catch(a){C(`Error dropping index: ${a.message}`),console.error("[TableDesigner] Error dropping index:",a)}}},ap=async()=>{if(q&&t){if(!ad.trim())return void C("Table name is required");if(ad===t)return void C("New table name must be different from current name");C(""),A(`Renaming table "${t}" to "${ad}"...`);try{console.log("[TableDesigner] Renaming table:",t,"to",ad);let a=`ALTER TABLE ${t} RENAME TO ${ad}`;console.log("[TableDesigner] Executing SQL:",a),await q.execute(a),console.log("[TableDesigner] Table renamed successfully"),u(ad),await ai(),await aj(ad),ac(!1),ae(""),A(`Table renamed to "${ad}" successfully`),console.log("[TableDesigner] Dialog closed, state reset")}catch(a){C(`Error renaming table: ${a.message}`),console.error("[TableDesigner] Error renaming table:",a)}}},aq=async()=>{if(q&&t){C(""),A(`Dropping table "${t}"...`);try{console.log("[TableDesigner] Dropping table:",t);let a=`DROP TABLE ${t}`;console.log("[TableDesigner] Executing SQL:",a),await q.execute(a),console.log("[TableDesigner] Table dropped successfully"),u(""),w([]),y([]),await ai(),ag(!1),A(`Table "${t}" dropped successfully`),console.log("[TableDesigner] Dialog closed, state reset")}catch(a){C(`Error dropping table: ${a.message}`),console.error("[TableDesigner] Error dropping table:",a)}}};return(0,b.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Table Designer"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Visual table structure editor - view and modify table columns, indexes, and constraints"})]}),z&&(0,b.jsx)("div",{className:"mb-4 p-3 bg-muted rounded-md text-sm",children:z}),q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(i.Card,{className:"mb-6",children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsx)(i.CardTitle,{children:"Select Table"}),(0,b.jsx)(i.CardDescription,{children:"Choose a table to view and edit its structure"})]}),(0,b.jsx)(i.CardContent,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)(k.Select,{value:t,onValueChange:a=>{u(a)},children:[(0,b.jsx)(k.SelectTrigger,{id:"tableSelect","data-testid":"table-select",className:"w-full",children:(0,b.jsx)(k.SelectValue,{placeholder:"Select a table"})}),(0,b.jsx)(k.SelectContent,{children:r.map(a=>(0,b.jsx)(k.SelectItem,{value:a.name,children:a.name},a.name))})]})}),(0,b.jsx)(e.Button,{id:"refreshTables",onClick:ai,variant:"outline",children:"Refresh"}),t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{onClick:()=>{console.log("[TableDesigner] Rename table clicked"),ae(t||""),C(""),ac(!0)},variant:"outline",children:"Rename Table"}),(0,b.jsx)(e.Button,{onClick:()=>{console.log("[TableDesigner] Drop table clicked"),C(""),ag(!0)},variant:"destructive",children:"Drop Table"})]})]})})]}),t&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(i.Card,{className:"mb-6",children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(i.CardTitle,{"data-table-title":!0,children:["Columns - ",t]}),(0,b.jsxs)(i.CardDescription,{children:[v.length," ",1===v.length?"column":"columns"]})]}),(0,b.jsx)(e.Button,{id:"addColumn",variant:"outline",onClick:()=>E(!0),children:"Add Column"})]})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsx)("div",{"data-column-list":!0,children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Name"}),(0,b.jsx)(l.TableHead,{children:"Type"}),(0,b.jsx)(l.TableHead,{children:"Constraints"}),(0,b.jsx)(l.TableHead,{children:"Default"}),(0,b.jsx)(l.TableHead,{children:"Actions"})]})}),(0,b.jsx)(l.TableBody,{children:v.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(m.Badge,{variant:"secondary",children:a.type})}),(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[1===a.pk&&(0,b.jsx)(m.Badge,{variant:"default",children:"Primary Key"}),1===a.notnull&&(0,b.jsx)(m.Badge,{variant:"outline",children:"NOT NULL"})]})}),(0,b.jsx)(l.TableCell,{className:"text-muted-foreground",children:null!==a.dflt_value?String(a.dflt_value):"-"}),(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>(a=>{if(console.log("[TableDesigner] Edit column clicked:",a.name),1===a.pk){C("Cannot modify PRIMARY KEY column"),A("Cannot modify PRIMARY KEY column");return}O(a),Q(a.name),M(!0)})(a),children:"Edit"}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>(a=>{if(console.log("[TableDesigner] Delete column clicked:",a.name),1===a.pk){C("Cannot delete PRIMARY KEY column"),A("Cannot delete PRIMARY KEY column");return}K(a),I(!0)})(a),children:"Delete"})]})})]},a.cid))})]})})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(i.CardTitle,{children:"Indexes"}),(0,b.jsxs)(i.CardDescription,{children:[x.length," ",1===x.length?"index":"indexes"]})]}),(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{console.log("[TableDesigner] Create index clicked"),U(""),W(!1),Y([]),C(""),S(!0)},children:"Add Index"})]})}),(0,b.jsx)(i.CardContent,{children:0===x.length?(0,b.jsx)("p",{className:"text-muted-foreground text-center py-4",children:"No indexes defined for this table"}):(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Name"}),(0,b.jsx)(l.TableHead,{children:"Type"}),(0,b.jsx)(l.TableHead,{children:"Origin"}),(0,b.jsx)(l.TableHead,{children:"Actions"})]})}),(0,b.jsx)(l.TableBody,{children:x.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(m.Badge,{variant:1===a.unique?"default":"secondary",children:1===a.unique?"UNIQUE":"INDEX"})}),(0,b.jsx)(l.TableCell,{className:"text-muted-foreground",children:a.origin}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",disabled:"pk"===a.origin,"data-index-name":a.name,onClick:()=>{var b;console.log("[TableDesigner] Drop index clicked:",b=a.name),aa(b),C(""),$(!0)},children:"Delete"})})]},a.name))})]})})]})]})]}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("p",{className:"mb-4",children:"No database loaded. Please create or import a database first."}),(0,b.jsx)(e.Button,{asChild:!0,children:(0,b.jsx)("a",{href:"/db",children:"Go to Database Management"})})]}),(0,b.jsx)(j.Dialog,{open:D,onOpenChange:E,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Add Column"}),(0,b.jsxs)(j.DialogDescription,{children:["Add a new column to ",t]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[B&&(0,b.jsx)("div",{className:"p-3 bg-destructive/10 text-destructive rounded-md text-sm",children:B}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"columnName",children:"Column Name"}),(0,b.jsx)(f.Input,{id:"columnName",placeholder:"e.g., email",value:F.name,onChange:a=>G({...F,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"columnType",children:"Data Type"}),(0,b.jsxs)(k.Select,{value:F.type,onValueChange:a=>G({...F,type:a}),children:[(0,b.jsx)(k.SelectTrigger,{id:"columnType",children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"TEXT",children:"TEXT"}),(0,b.jsx)(k.SelectItem,{value:"INTEGER",children:"INTEGER"}),(0,b.jsx)(k.SelectItem,{value:"REAL",children:"REAL"}),(0,b.jsx)(k.SelectItem,{value:"BLOB",children:"BLOB"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"defaultValue",children:"Default Value (optional)"}),(0,b.jsx)(f.Input,{id:"defaultValue",placeholder:"Leave empty for NULL",value:F.defaultValue,onChange:a=>G({...F,defaultValue:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(g.Label,{children:"Constraints"}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(h.Checkbox,{id:"notNull",checked:F.notNull,onCheckedChange:a=>G({...F,notNull:a})}),(0,b.jsx)("label",{htmlFor:"notNull",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"NOT NULL"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(h.Checkbox,{id:"unique",checked:F.unique,onCheckedChange:a=>G({...F,unique:a})}),(0,b.jsx)("label",{htmlFor:"unique",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"UNIQUE"})]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,b.jsx)(e.Button,{id:"confirmAddColumn",onClick:ak,children:"Add"})]})]})}),(0,b.jsx)(j.Dialog,{open:H,onOpenChange:I,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Delete Column"}),(0,b.jsxs)(j.DialogDescription,{children:['Are you sure you want to delete the column "',J?.name,'"?']})]}),(0,b.jsxs)("div",{className:"py-4",children:[B&&(0,b.jsx)("div",{className:"p-3 bg-destructive/10 text-destructive rounded-md text-sm mb-4",children:B}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("p",{className:"text-muted-foreground",children:[(0,b.jsx)("strong",{children:"Warning:"})," This action cannot be undone. All data in this column will be lost."]}),J&&(0,b.jsxs)("div",{className:"mt-4 p-3 bg-muted rounded-md",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Column:"})," ",J.name]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Type:"})," ",J.type]}),1===J.pk&&(0,b.jsx)("p",{className:"text-destructive mt-2",children:"⚠️ Cannot delete PRIMARY KEY column"})]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{I(!1),K(null)},children:"Cancel"}),(0,b.jsx)(e.Button,{id:"confirmDeleteColumn",variant:"destructive",onClick:al,disabled:J?.pk===1,children:"Delete"})]})]})}),(0,b.jsx)(j.Dialog,{open:L,onOpenChange:M,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Edit Column"}),(0,b.jsx)(j.DialogDescription,{children:"Modify column properties. Column name can be changed."})]}),(0,b.jsxs)("div",{className:"py-4",children:[B&&(0,b.jsx)("div",{className:"p-3 bg-destructive/10 text-destructive rounded-md text-sm mb-4",children:B}),(0,b.jsxs)("div",{className:"space-y-4",children:[N&&(0,b.jsxs)("div",{className:"p-3 bg-muted rounded-md text-sm",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Current column:"})," ",N.name]}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Type:"})," ",N.type]}),1===N.pk&&(0,b.jsx)("p",{className:"text-destructive mt-2",children:"⚠️ Cannot modify PRIMARY KEY column"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"editColumnName",children:"Column Name"}),(0,b.jsx)(f.Input,{id:"editColumnName",value:P,onChange:a=>Q(a.target.value),placeholder:"Enter new column name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"editColumnType",children:"Data Type"}),(0,b.jsxs)(k.Select,{value:N?.type||"TEXT",disabled:!0,children:[(0,b.jsx)(k.SelectTrigger,{id:"editColumnType",children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"TEXT",children:"TEXT"}),(0,b.jsx)(k.SelectItem,{value:"INTEGER",children:"INTEGER"}),(0,b.jsx)(k.SelectItem,{value:"REAL",children:"REAL"}),(0,b.jsx)(k.SelectItem,{value:"BLOB",children:"BLOB"})]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Type modification not yet supported"})]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{M(!1),O(null),Q(""),C("")},children:"Cancel"}),(0,b.jsx)(e.Button,{id:"confirmEditColumn",onClick:am,disabled:N?.pk===1,children:"Save"})]})]})}),(0,b.jsx)(j.Dialog,{open:R,onOpenChange:S,children:(0,b.jsxs)(j.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Create Index"}),(0,b.jsxs)(j.DialogDescription,{children:["Create a new index on ",t,". Select one or more columns to index."]})]}),(0,b.jsxs)("div",{className:"py-4",children:[B&&(0,b.jsx)("div",{className:"p-3 bg-destructive/10 text-destructive rounded-md text-sm mb-4",children:B}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"indexName",children:"Index Name"}),(0,b.jsx)(f.Input,{id:"indexName",value:T,onChange:a=>U(a.target.value),placeholder:"e.g., idx_email or idx_user_location"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"indexUnique",name:"unique",checked:V,onChange:a=>W(a.target.checked),className:"h-4 w-4 rounded border-gray-300"}),(0,b.jsx)(g.Label,{htmlFor:"indexUnique",className:"font-normal cursor-pointer",children:"Create UNIQUE index (enforces uniqueness constraint)"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Select Columns for Index"}),(0,b.jsx)("div",{className:"border rounded-md p-4 space-y-2 max-h-64 overflow-y-auto",children:0===v.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No columns available"}):v.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:`col-${a.name}`,"data-column":a.name,checked:X.includes(a.name),onChange:()=>{var b;return b=a.name,void Y(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"h-4 w-4 rounded border-gray-300"}),(0,b.jsxs)(g.Label,{htmlFor:`col-${a.name}`,className:"font-normal cursor-pointer flex-1",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name}),(0,b.jsxs)("span",{className:"text-muted-foreground ml-2",children:["(",a.type,")"]}),1===a.pk&&(0,b.jsx)("span",{className:"ml-2 text-xs text-blue-600",children:"PRIMARY KEY"})]})]},a.name))}),X.length>0&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Selected: ",X.join(", ")]})]})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{S(!1),U(""),W(!1),Y([]),C("")},children:"Cancel"}),(0,b.jsx)(e.Button,{id:"confirmCreateIndex",onClick:an,children:"Create"})]})]})}),(0,b.jsx)(j.Dialog,{open:Z,onOpenChange:$,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Drop Index"}),(0,b.jsx)(j.DialogDescription,{children:"Are you sure you want to drop this index? This action cannot be undone."})]}),(0,b.jsxs)("div",{className:"py-4",children:[B&&(0,b.jsx)("div",{className:"p-3 bg-destructive/10 text-destructive rounded-md text-sm mb-4",children:B}),_&&(0,b.jsxs)("div",{className:"p-3 bg-muted rounded-md text-sm",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{children:"Index name:"})," ",_]}),(0,b.jsx)("p",{className:"text-destructive mt-2",children:"⚠️ Dropping this index is permanent and cannot be undone."})]})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{$(!1),aa(null),C("")},children:"Cancel"}),(0,b.jsx)(e.Button,{id:"confirmDropIndex",variant:"destructive",onClick:ao,children:"Delete"})]})]})}),(0,b.jsx)(j.Dialog,{open:ab,onOpenChange:ac,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Rename Table"}),(0,b.jsx)(j.DialogDescription,{children:"Enter a new name for the table. All data and indexes will be preserved."})]}),(0,b.jsxs)("div",{className:"py-4",children:[B&&(0,b.jsx)("div",{className:"p-3 bg-destructive/10 text-destructive rounded-md text-sm mb-4",children:B}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{htmlFor:"newTableName",children:"New Table Name"}),(0,b.jsx)(f.Input,{id:"newTableName",value:ad,onChange:a=>ae(a.target.value),placeholder:"Enter new table name",className:"mt-1"})]})})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{ac(!1),ae(""),C("")},children:"Cancel"}),(0,b.jsx)(e.Button,{id:"confirmRenameTable",onClick:ap,children:"Rename"})]})]})}),(0,b.jsx)(j.Dialog,{open:af,onOpenChange:ag,children:(0,b.jsxs)(j.DialogContent,{children:[(0,b.jsxs)(j.DialogHeader,{children:[(0,b.jsx)(j.DialogTitle,{children:"Drop Table"}),(0,b.jsx)(j.DialogDescription,{children:"Are you sure you want to drop this table? This action cannot be undone."})]}),(0,b.jsxs)("div",{className:"py-4",children:[B&&(0,b.jsx)("div",{className:"p-3 bg-destructive/10 text-destructive rounded-md text-sm mb-4",children:B}),t&&(0,b.jsx)("div",{className:"p-4 bg-destructive/10 border border-destructive rounded-md",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{className:"font-semibold text-destructive",children:["Table: ",(0,b.jsx)("span",{className:"font-mono",children:t})]}),(0,b.jsxs)("p",{className:"text-sm",children:[v.length," ",1===v.length?"column":"columns",","," ",x.length," ",1===x.length?"index":"indexes"]}),(0,b.jsx)("p",{className:"text-destructive text-sm font-semibold mt-3",children:"⚠️ All data will be permanently deleted and cannot be recovered!"})]})})]}),(0,b.jsxs)(j.DialogFooter,{children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>{ag(!1),C("")},children:"Cancel"}),(0,b.jsx)(e.Button,{id:"confirmDropTable",variant:"destructive",onClick:aq,children:"Drop Table"})]})]})})]})}function o(){let{currentDbName:a}=(0,d.useDatabaseStore)();return(0,b.jsx)(n,{})}a.s(["default",()=>o])}];

//# sourceMappingURL=pwa_app_db_designer_page_tsx_98c435f3._.js.map