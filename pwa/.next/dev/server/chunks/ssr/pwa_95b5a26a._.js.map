{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/nicholas.piesco/Downloads/absurder-sql/pwa/lib/db/store.ts"],"sourcesContent":["/**\n * Database State Management Store (Zustand)\n * \n * Central state for database instance and metadata\n * Uses localStorage persistence to maintain state across page navigations\n */\n\nimport { create } from 'zustand';\nimport { persist, createJSONStorage } from 'zustand/middleware';\n\ninterface DatabaseStore {\n  db: any | null;\n  currentDbName: string;\n  loading: boolean;\n  status: string;\n  tableCount: number;\n  showSystemTables: boolean;\n  _hasHydrated: boolean;\n  \n  setDb: (db: any) => void;\n  setCurrentDbName: (name: string) => void;\n  setLoading: (loading: boolean) => void;\n  setStatus: (status: string) => void;\n  setTableCount: (count: number) => void;\n  setShowSystemTables: (show: boolean) => void;\n  setHasHydrated: (hydrated: boolean) => void;\n  reset: () => void;\n}\n\nexport const useDatabaseStore = create<DatabaseStore>()(\n  persist(\n    (set) => ({\n      db: null,\n      currentDbName: '',\n      loading: true,\n      status: 'Initializing...',\n      tableCount: 0,\n      showSystemTables: false,\n      _hasHydrated: false,\n      \n      setDb: (db) => set({ db }),\n      setCurrentDbName: (name) => set({ currentDbName: name }),\n      setLoading: (loading) => set({ loading }),\n      setStatus: (status) => set({ status }),\n      setTableCount: (count) => set({ tableCount: count }),\n      setShowSystemTables: (show) => set({ showSystemTables: show }),\n      setHasHydrated: (hydrated) => set({ _hasHydrated: hydrated }),\n      reset: () => set({\n        db: null,\n        currentDbName: '',\n        loading: false,\n        status: 'Reset',\n        tableCount: 0,\n        showSystemTables: false,\n      }),\n    }),\n    {\n      name: 'absurder-sql-database-store',\n      storage: createJSONStorage(() => localStorage),\n      // Only persist these fields (not db instance)\n      partialize: (state) => ({\n        currentDbName: state.currentDbName,\n        tableCount: state.tableCount,\n      }),\n      onRehydrateStorage: () => (state) => {\n        console.log('[STORE] Zustand hydration complete');\n        state?.setHasHydrated(true);\n      },\n    }\n  )\n);\n"],"names":[],"mappings":"AAAA;;;;;CAKC;;;;AAED;AACA;;;AAqBO,MAAM,mBAAmB,IAAA,yJAAM,IACpC,IAAA,+JAAO,EACL,CAAC,MAAQ,CAAC;QACR,IAAI;QACJ,eAAe;QACf,SAAS;QACT,QAAQ;QACR,YAAY;QACZ,kBAAkB;QAClB,cAAc;QAEd,OAAO,CAAC,KAAO,IAAI;gBAAE;YAAG;QACxB,kBAAkB,CAAC,OAAS,IAAI;gBAAE,eAAe;YAAK;QACtD,YAAY,CAAC,UAAY,IAAI;gBAAE;YAAQ;QACvC,WAAW,CAAC,SAAW,IAAI;gBAAE;YAAO;QACpC,eAAe,CAAC,QAAU,IAAI;gBAAE,YAAY;YAAM;QAClD,qBAAqB,CAAC,OAAS,IAAI;gBAAE,kBAAkB;YAAK;QAC5D,gBAAgB,CAAC,WAAa,IAAI;gBAAE,cAAc;YAAS;QAC3D,OAAO,IAAM,IAAI;gBACf,IAAI;gBACJ,eAAe;gBACf,SAAS;gBACT,QAAQ;gBACR,YAAY;gBACZ,kBAAkB;YACpB;IACF,CAAC,GACD;IACE,MAAM;IACN,SAAS,IAAA,yKAAiB,EAAC,IAAM;IACjC,8CAA8C;IAC9C,YAAY,CAAC,QAAU,CAAC;YACtB,eAAe,MAAM,aAAa;YAClC,YAAY,MAAM,UAAU;QAC9B,CAAC;IACD,oBAAoB,IAAM,CAAC;YACzB,QAAQ,GAAG,CAAC;YACZ,OAAO,eAAe;QACxB;AACF","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///Users/nicholas.piesco/Downloads/absurder-sql/pwa/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,6KAAO,EAAC,IAAA,oJAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///Users/nicholas.piesco/Downloads/absurder-sql/pwa/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,qPAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qPAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,qPAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,qPAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qPAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,qPAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,qPAAC;QACC,aAAU;QACV,WAAW,IAAA,yHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":["file:///Users/nicholas.piesco/Downloads/absurder-sql/pwa/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  type = \"button\",\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      type={asChild ? undefined : type}\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,8KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,OAAO,QAAQ,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,+KAAI,GAAG;IAE9B,qBACE,qPAAC;QACC,aAAU;QACV,MAAM,UAAU,YAAY;QAC5B,WAAW,IAAA,yHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 248, "column": 0}, "map": {"version":3,"sources":["file:///Users/nicholas.piesco/Downloads/absurder-sql/pwa/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,8KAAG,EACvB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,qPAAC;QAAI,WAAW,IAAA,yHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE","debugId":null}},
    {"offset": {"line": 290, "column": 0}, "map": {"version":3,"sources":["file:///Users/nicholas.piesco/Downloads/absurder-sql/pwa/app/db/storage/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { useDatabaseStore } from '@/lib/db/store';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { RefreshCw, Database, Table, List, HardDrive } from 'lucide-react';\nimport { Badge } from '@/components/ui/badge';\n\ninterface TableInfo {\n  name: string;\n  rowCount: number;\n  size: number;\n}\n\ninterface IndexInfo {\n  name: string;\n  tableName: string;\n  size: number;\n}\n\nfunction StorageAnalysisContent() {\n  const { db, _hasHydrated, setDb } = useDatabaseStore();\n  const currentDbName = useDatabaseStore((state) => state.currentDbName);\n\n  // Track window.testDb for E2E tests\n  const [windowTestDb, setWindowTestDb] = useState<any>(null);\n  const activeDb = db || windowTestDb;\n\n  const [loading, setLoading] = useState(false);\n  const [dbSize, setDbSize] = useState<number>(0);\n  const [tables, setTables] = useState<TableInfo[]>([]);\n  const [indexes, setIndexes] = useState<IndexInfo[]>([]);\n  const [error, setError] = useState<string | null>(null);\n\n  // Initialize WASM and expose testDb globally for E2E tests\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n\n    // Wait for Zustand hydration before attempting database restoration\n    if (!_hasHydrated) return;\n\n    async function initializeWasm() {\n      try {\n        // ALWAYS initialize WASM first, even if db exists\n        const init = (await import('@npiesco/absurder-sql')).default;\n        await init();\n\n        // Then expose Database class\n        const { Database } = await import('@npiesco/absurder-sql');\n        (window as any).Database = Database;\n\n        // If db exists from Zustand, expose it as testDb\n        if (db) {\n          // Add .db property pointing to itself for test compatibility (only if not already set)\n          if (!(db as any).db) (db as any).db = db;\n          (window as any).testDb = db;\n        } else if (currentDbName) {\n          // Restore database from storage if currentDbName exists\n          console.log('[StoragePage] Restoring database from currentDbName:', currentDbName);\n          const dbInstance = await Database.newDatabase(currentDbName);\n          // Add .db property pointing to itself for test compatibility (only if not already set)\n          if (!(dbInstance as any).db) (dbInstance as any).db = dbInstance;\n          setDb(dbInstance);\n          (window as any).testDb = dbInstance;\n          console.log('[StoragePage] Database restored successfully');\n        }\n      } catch (err: any) {\n        console.error('Failed to initialize WASM:', err);\n      }\n    }\n\n    initializeWasm();\n  }, [db, currentDbName, _hasHydrated, setDb]);\n\n  // Sync window.testDb to component state (for E2E tests)\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n\n    const checkTestDb = () => {\n      const testDb = (window as any).testDb;\n      if (testDb && !windowTestDb) {\n        setWindowTestDb(testDb);\n      }\n    };\n\n    // Check immediately\n    checkTestDb();\n\n    // Also check periodically in case testDb is set after component mounts\n    const interval = setInterval(checkTestDb, 50);\n\n    return () => clearInterval(interval);\n  }, [windowTestDb]);\n\n  const formatSize = (bytes: number): string => {\n    if (bytes === 0) return '0 bytes';\n    if (bytes < 1024) return `${bytes} bytes`;\n    if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(2)} KB`;\n    if (bytes < 1024 * 1024 * 1024) return `${(bytes / (1024 * 1024)).toFixed(2)} MB`;\n    return `${(bytes / (1024 * 1024 * 1024)).toFixed(2)} GB`;\n  };\n\n  const calculatePageSize = async (): Promise<number> => {\n    try {\n      if (!activeDb) {\n        return 4096; // Default SQLite page size\n      }\n\n      const result = await activeDb.execute('PRAGMA page_size');\n      if (result.rows && result.rows.length > 0) {\n        const val = result.rows[0].values[0];\n        return (val as any).value as number;\n      }\n      return 4096;\n    } catch (err) {\n      return 4096;\n    }\n  };\n\n  const calculateTableSize = async (tableName: string): Promise<number> => {\n    try {\n      if (!activeDb) return 0;\n\n      // Get page count for the table\n      const pageSize = await calculatePageSize();\n\n      // Query the internal SQLite table for page counts\n      const result = await activeDb.execute(\n        `SELECT SUM(pgsize) as size FROM dbstat WHERE name='${tableName}'`\n      );\n\n      if (result.rows && result.rows.length > 0) {\n        const val = result.rows[0].values[0];\n        if ((val as any).value) {\n          return (val as any).value as number;\n        }\n      }\n\n      // Fallback: estimate based on row count\n      const countResult = await activeDb.execute(`SELECT COUNT(*) as count FROM ${tableName}`);\n      if (countResult.rows && countResult.rows.length > 0) {\n        const rowCount = (countResult.rows[0].values[0] as any).value as number;\n        // Rough estimate: 100 bytes per row minimum\n        return rowCount * 100;\n      }\n\n      return 0;\n    } catch (err) {\n      // Fallback estimation\n      try {\n        const countResult = await activeDb!.execute(`SELECT COUNT(*) as count FROM ${tableName}`);\n        if (countResult.rows && countResult.rows.length > 0) {\n          const rowCount = (countResult.rows[0].values[0] as any).value as number;\n          return rowCount * 100; // Estimate 100 bytes per row\n        }\n      } catch (fallbackErr) {\n        // Silent failure\n      }\n      return 0;\n    }\n  };\n\n  const calculateIndexSize = async (indexName: string): Promise<number> => {\n    try {\n      if (!activeDb) return 0;\n\n      // Try to get index size from dbstat\n      const result = await activeDb.execute(\n        `SELECT SUM(pgsize) as size FROM dbstat WHERE name='${indexName}'`\n      );\n\n      if (result.rows && result.rows.length > 0) {\n        const val = result.rows[0].values[0];\n        if ((val as any).value) {\n          return (val as any).value as number;\n        }\n      }\n\n      // Fallback: estimate based on indexed table row count\n      return 1024; // Minimum 1KB estimate for indexes\n    } catch (err) {\n      return 1024; // Default estimate\n    }\n  };\n\n  const loadStorageInfo = useCallback(async () => {\n    if (!activeDb) {\n      setError('No database connected');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Get all tables\n      const tablesResult = await activeDb.execute(\n        \"SELECT name FROM sqlite_master WHERE type='table' AND name NOT LIKE 'sqlite_%'\"\n      );\n\n      const tableInfoPromises = tablesResult.rows.map(async (row: any) => {\n        const tableName = (row.values[0] as any).value as string;\n\n        // Get row count\n        const countResult = await activeDb.execute(`SELECT COUNT(*) as count FROM ${tableName}`);\n        const rowCount = (countResult.rows[0].values[0] as any).value as number;\n\n        // Calculate size\n        const size = await calculateTableSize(tableName);\n\n        return {\n          name: tableName,\n          rowCount,\n          size,\n        };\n      });\n\n      const tableInfos = await Promise.all(tableInfoPromises);\n      setTables(tableInfos);\n\n      // Get all indexes\n      const indexesResult = await activeDb.execute(\n        \"SELECT name, tbl_name FROM sqlite_master WHERE type='index' AND name NOT LIKE 'sqlite_%'\"\n      );\n\n      const indexInfoPromises = indexesResult.rows.map(async (row: any) => {\n        const indexName = (row.values[0] as any).value as string;\n        const tableName = (row.values[1] as any).value as string;\n        const size = await calculateIndexSize(indexName);\n\n        return {\n          name: indexName,\n          tableName,\n          size,\n        };\n      });\n\n      const indexInfos = await Promise.all(indexInfoPromises);\n      setIndexes(indexInfos);\n\n      // Calculate total database size\n      const totalTableSize = tableInfos.reduce((sum: number, table: TableInfo) => sum + table.size, 0);\n      const totalIndexSize = indexInfos.reduce((sum: number, index: IndexInfo) => sum + index.size, 0);\n      const totalSize = totalTableSize + totalIndexSize;\n\n      setDbSize(totalSize > 0 ? totalSize : 8192); // Minimum SQLite database is 8KB\n\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load storage information');\n    } finally {\n      setLoading(false);\n    }\n  }, [activeDb]);\n\n  useEffect(() => {\n    if (activeDb) {\n      loadStorageInfo();\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activeDb]);\n\n  const handleRefresh = () => {\n    loadStorageInfo();\n  };\n\n  if (error) {\n    return (\n      <div className=\"container mx-auto p-6\">\n        <Card className=\"border-red-200 bg-red-50\">\n          <CardHeader>\n            <CardTitle className=\"text-red-700\">Error</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-red-600\">{error}</p>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto p-6 space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold tracking-tight\">Storage Analysis</h1>\n          <p className=\"text-muted-foreground\">\n            Analyze database storage usage and optimize performance\n          </p>\n        </div>\n        <Button\n          id=\"refreshStorageButton\"\n          onClick={handleRefresh}\n          disabled={loading}\n          variant=\"outline\"\n        >\n          <RefreshCw className={`mr-2 h-4 w-4 ${loading ? 'animate-spin' : ''}`} />\n          Refresh\n        </Button>\n      </div>\n\n      {/* Database Size Card */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Database className=\"h-5 w-5\" />\n            Database Size\n          </CardTitle>\n          <CardDescription>Total storage used by the database</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-4xl font-bold\" data-testid=\"db-size\">\n            {formatSize(dbSize)}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Tables Section */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Table className=\"h-5 w-5\" />\n            Tables\n          </CardTitle>\n          <CardDescription>Storage breakdown by table</CardDescription>\n        </CardHeader>\n        <CardContent>\n          {tables.length === 0 ? (\n            <p className=\"text-muted-foreground\">No tables found in this database.</p>\n          ) : (\n            <div className=\"space-y-4\">\n              {tables.map((table) => (\n                <div\n                  key={table.name}\n                  data-table={table.name}\n                  data-table-name={table.name}\n                  className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-accent\"\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"font-medium\">{table.name}</div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      {table.rowCount} {table.rowCount === 1 ? 'row' : 'rows'}\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <div className=\"font-medium table-size\" data-testid=\"table-size\">\n                      {formatSize(table.size)}\n                    </div>\n                    <Badge variant=\"secondary\" className=\"mt-1\">\n                      <HardDrive className=\"h-3 w-3 mr-1\" />\n                      Table\n                    </Badge>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Indexes Section */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <List className=\"h-5 w-5\" />\n            Indexes\n          </CardTitle>\n          <CardDescription>Storage used by indexes</CardDescription>\n        </CardHeader>\n        <CardContent>\n          {indexes.length === 0 ? (\n            <p className=\"text-muted-foreground\">No indexes found in this database.</p>\n          ) : (\n            <div className=\"space-y-4\">\n              {indexes.map((index) => (\n                <div\n                  key={index.name}\n                  data-index={index.name}\n                  className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-accent\"\n                >\n                  <div className=\"flex-1\">\n                    <div className=\"font-medium\">{index.name}</div>\n                    <div className=\"text-sm text-muted-foreground\">\n                      on table: {index.tableName}\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <div className=\"font-medium index-size\" data-testid=\"index-size\">\n                      {formatSize(index.size)}\n                    </div>\n                    <Badge variant=\"secondary\" className=\"mt-1\">\n                      <List className=\"h-3 w-3 mr-1\" />\n                      Index\n                    </Badge>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nexport default function StorageAnalysisPage() {\n  const currentDbName = useDatabaseStore((state) => state.currentDbName);\n  \n  // Don't render until we have a database name from the store\n  if (!currentDbName) {\n    return (\n      <div className=\"container mx-auto p-8\">\n        <div className=\"text-center text-gray-600\">\n          No database selected. Please create or open a database first.\n        </div>\n      </div>\n    );\n  }\n  \n  return <StorageAnalysisContent />;\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}